Configurations:

general:
  device: cuda
  seed: 100
  conv_mode: patches
  deterministic: false
  double_fp: false
  loss_reduction_func: sum
  sparse_alpha: true
  save_adv_example: false
  precompile_jit: false
  complete_verifier: bab
  enable_incomplete_verification: true
  csv_name: oval21_instances.csv
  results_file: out.txt
  root_path: ../../vnncomp2021/benchmarks/oval21
model:
  name: null
  path: null
  onnx_path: null
  onnx_path_prefix: ''
  cache_onnx_conversion: false
  onnx_quirks: null
  input_shape: null
  onnx_loader: default_onnx_and_vnnlib_loader
  onnx_optimization_flags: none
data:
  start: 23
  end: 24
  select_instance: null
  num_outputs: 10
  mean: 0.0
  std: 1.0
  pkl_path: null
  dataset: null
  data_filter_path: null
  data_idx_file: null
specification:
  type: lp
  robustness_type: verified-acc
  norm: .inf
  epsilon: null
  epsilon_min: 0.0
  vnnlib_path: null
  vnnlib_path_prefix: ''
solver:
  batch_size: 200
  min_batch_size_ratio: 0.1
  use_float64_in_last_iteration: false
  early_stop_patience: 10
  start_save_best: 0.5
  bound_prop_method: alpha-crown
  init_bound_prop_method: same
  prune_after_crown: false
  crown:
    batch_size: 1000000000
    max_crown_size: 1000000000
  alpha-crown:
    alpha: true
    lr_alpha: 0.1
    iteration: 100
    share_slopes: false
    no_joint_opt: false
    lr_decay: 0.98
    full_conv_alpha: true
  beta-crown:
    lr_alpha: 0.01
    lr_beta: 0.01
    lr_decay: 0.98
    optimizer: adam
    iteration: 50
    beta: true
    beta_warmup: true
    enable_opt_interm_bounds: false
    all_node_split_LP: false
  forward:
    refine: false
    dynamic: false
    max_dim: 10000
  intermediate_refinement:
    enabled: false
    batch_size: 10
    opt_coeffs: false
    opt_bias: false
    lr: 0.05
    layers: [-1]
    max_domains: 1000
  multi_class:
    label_batch_size: 32
    skip_with_refined_bound: true
  mip:
    parallel_solvers: null
    solver_threads: 1
    refine_neuron_timeout: 15
    refine_neuron_time_percentage: 0.8
    early_stop: true
    adv_warmup: true
    mip_solver: gurobi
bab:
  initial_max_domains: 1
  max_domains: .inf
  decision_thresh: 0
  timeout: 360
  timeout_scale: 1
  override_timeout: null
  get_upper_bound: false
  dfs_percent: 0.0
  pruning_in_iteration: true
  pruning_in_iteration_ratio: 0.2
  sort_targets: false
  batched_domain_list: true
  optimized_intermediate_layers: ''
  interm_transfer: true
  cut:
    enabled: false
    implication: false
    bab_cut: false
    lp_cut: false
    method: null
    lr: 0.01
    lr_decay: 1.0
    iteration: 100
    bab_iteration: -1
    early_stop_patience: -1
    lr_beta: 0.02
    number_cuts: 50
    topk_cuts_in_filter: 1000
    batch_size_primal: 100
    max_num: 1000000000
    patches_cut: false
    cplex_cuts: false
    cplex_cuts_wait: 0
    cplex_cuts_revpickup: true
    cut_reference_bounds: true
    fix_intermediate_bounds: false
    _tmp_cuts: null
    fixed_cuts: false
    add_implied_cuts: false
    add_input_cuts: false
  branching:
    method: kfsb
    candidates: 10
    reduceop: max
    sb_coeff_thresh: 0.001
    enable_intermediate_bound_opt: false
    branching_input_and_activation: false
    branching_input_and_activation_order: [input, relu]
    branching_input_iterations: 30
    branching_relu_iterations: 50
    sort_domain_interval: -1
    nonlinear_split:
      method: babsr_like
      branching_point_method: middle
      num_branches: 2
      branching_point_refinement: false
      naive_branching_score: false
      filter: false
      prioritize_mul: false
    input_split:
      enable: false
      enhanced_bound_prop_method: alpha-crown
      enhanced_branching_method: naive
      enhanced_bound_patience: 100000000.0
      attack_patience: 100000000.0
      adv_check: 0
  attack:
    enabled: false
    beam_candidates: 8
    beam_depth: 7
    max_dive_fix_ratio: 0.8
    min_local_free_ratio: 0.2
    mip_start_iteration: 5
    mip_timeout: 30.0
    adv_pool_threshold: null
    refined_mip_attacker: false
    refined_batch_size: null
attack:
  pgd_order: before
  pgd_steps: 100
  pgd_restarts: 30
  pgd_early_stop: true
  pgd_lr_decay: 0.99
  pgd_alpha: auto
  pgd_loss_mode: null
  enable_mip_attack: false
  cex_path: ./test_cex.txt
  attack_mode: PGD
  gama_lambda: 10.0
  gama_decay: 0.9
  check_clean: false
  input_split:
    pgd_steps: 100
    pgd_restarts: 30
    pgd_alpha: auto
  input_split_enhanced:
    pgd_steps: 200
    pgd_restarts: 5000000
    pgd_alpha: auto
  input_split_check_adv:
    pgd_steps: 5
    pgd_restarts: 5
    pgd_alpha: auto
debug:
  lp_test: null

Experiments at Tue Mar 28 14:40:16 2023 on zeratul
customized start/end sample from instance 23 to 24 in oval21_instances.csv
Internal results will be saved to a-b-crown_[oval21_instances]_start=23_end=24_iter=50_b=200_timeout=360_branching=kfsb-max-10_lra-init=0.1_lra=0.01_lrb=0.01_PGD=before_cplex_cuts=False_initial_max_domains=1.npz.

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0, vnnlib ID: 23 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Using onnx nets/cifar_deep_kw.onnx
Using vnnlib vnnlib/cifar_deep_kw-img5533-eps0.014379084967320262.vnnlib
Precompiled vnnlib file found at ../../vnncomp2021/benchmarks/oval21/vnnlib/cifar_deep_kw-img5533-eps0.014379084967320262.vnnlib.compiled
Loading onnx ../../vnncomp2021/benchmarks/oval21/nets/cifar_deep_kw.onnx wih quirks {}
Attack parameters: initialization=uniform, steps=100, restarts=30, alpha=0.015976786613464355, initialization=uniform, GAMA=False
Model output of first 5 examples:
 tensor([[ 2.12422514, -2.56402445,  2.55647516,  0.29432344,  0.60963291,
          0.24455148, -1.61683786,  0.23884836, -0.38029242, -1.50684512]],
       device='cuda:0')
Adv example prediction (first 2 examples and 2 restarts):
 tensor([[[ 2.44099689, -2.32209849,  2.47353458,  0.08037930,  0.54983628,
          -0.06469783, -1.75935006,  0.17848299, -0.23714949, -1.33987796],
         [ 2.44099689, -2.32209849,  2.47353458,  0.08037930,  0.54983628,
          -0.06469783, -1.75935006,  0.17848299, -0.23714949, -1.33987796]]],
       device='cuda:0')
PGD attack margin (first 2 examles and 10 specs):
 tensor([[[0.03253770, 4.79563332, 2.39315534, 1.92369831, 2.53823233,
          4.23288441, 2.29505157, 2.71068406, 3.81341267]]], device='cuda:0')
number of violation:  0
Attack finished in 2.3986 seconds.
PGD attack failed
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/13): BoundParams(name=/13, inputs=[])
  (/14): BoundParams(name=/14, inputs=[])
  (/15): BoundParams(name=/15, inputs=[])
  (/16): BoundParams(name=/16, inputs=[])
  (/17): BoundParams(name=/17, inputs=[])
  (/18): BoundParams(name=/18, inputs=[])
  (/19): BoundParams(name=/19, inputs=[])
  (/20): BoundParams(name=/20, inputs=[])
  (/21): BoundParams(name=/21, inputs=[])
  (/22): BoundParams(name=/22, inputs=[])
  (/23): BoundParams(name=/23, inputs=[])
  (/24): BoundParams(name=/24, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /13, /14])
  (/26): BoundRelu(name=/26, inputs=[/input])
  (/input.4): BoundConv(name=/input.4, inputs=[/26, /15, /16])
  (/28): BoundRelu(name=/28, inputs=[/input.4])
  (/input.8): BoundConv(name=/input.8, inputs=[/28, /17, /18])
  (/30): BoundRelu(name=/30, inputs=[/input.8])
  (/input.12): BoundConv(name=/input.12, inputs=[/30, /19, /20])
  (/32): BoundRelu(name=/32, inputs=[/input.12])
  (/33): BoundFlatten(name=/33, inputs=[/32])
  (/input.16): BoundLinear(name=/input.16, inputs=[/33, /21, /22])
  (/35): BoundRelu(name=/35, inputs=[/input.16])
  (/36): BoundLinear(name=/36, inputs=[/35, /23, /24])
)
Model prediction is: tensor([[ 2.12422514, -2.56402445,  2.55647516,  0.29432344,  0.60963291,
          0.24455148, -1.61683786,  0.23884836, -0.38029242, -1.50684512]],
       device='cuda:0')
layer /26 using sparse-features alpha with shape [90]; unstable size 90; total size 2048 (torch.Size([1, 8, 16, 16]))
layer /26 start_node /input.4 using sparse-spec alpha with unstable size 126 total_size 2048 output_shape (8, 16, 16)
layer /26 start_node /input.8 using sparse-spec alpha with unstable size 187 total_size 2048 output_shape (8, 16, 16)
layer /26 start_node /input.12 using sparse-spec alpha with unstable size 32 total_size 512 output_shape (8, 8, 8)
layer /26 start_node /input.16 using sparse-spec alpha with unstable size 23 total_size 100 output_shape torch.Size([100])
layer /26 start_node /36 using full alpha with unstable size None total_size 9 output_shape 9
layer /28 using sparse-features alpha with shape [126]; unstable size 126; total size 2048 (torch.Size([1, 8, 16, 16]))
layer /28 start_node /input.8 using sparse-spec alpha with unstable size 187 total_size 2048 output_shape (8, 16, 16)
layer /28 start_node /input.12 using sparse-spec alpha with unstable size 32 total_size 512 output_shape (8, 8, 8)
layer /28 start_node /input.16 using sparse-spec alpha with unstable size 23 total_size 100 output_shape torch.Size([100])
layer /28 start_node /36 using full alpha with unstable size None total_size 9 output_shape 9
layer /30 using sparse-features alpha with shape [187]; unstable size 187; total size 2048 (torch.Size([1, 8, 16, 16]))
layer /30 start_node /input.12 using sparse-spec alpha with unstable size 32 total_size 512 output_shape (8, 8, 8)
layer /30 start_node /input.16 using sparse-spec alpha with unstable size 23 total_size 100 output_shape torch.Size([100])
layer /30 start_node /36 using full alpha with unstable size None total_size 9 output_shape 9
layer /32 using sparse-features alpha with shape [32]; unstable size 32; total size 512 (torch.Size([1, 8, 8, 8]))
layer /32 start_node /input.16 using sparse-spec alpha with unstable size 23 total_size 100 output_shape torch.Size([100])
layer /32 start_node /36 using full alpha with unstable size None total_size 9 output_shape 9
layer /35 using sparse-features alpha with shape [23]; unstable size 23; total size 100 (torch.Size([1, 100]))
layer /35 start_node /36 using full alpha with unstable size None total_size 9 output_shape 9
Optimizable variables initialized.
initial CROWN bounds: tensor([[-0.10587621,  3.94706154,  1.63545597,  1.46117163,  1.59619904,
          3.46744108,  1.39417803,  1.90770555,  3.07346916]], device='cuda:0') None
best_l after optimization: 18.662857055664062
alpha/beta optimization time: 12.884278535842896
initial alpha-CROWN bounds: tensor([[-0.08838892,  4.00974178,  1.65500855,  1.47720838,  1.62312329,
          3.49446368,  1.42921269,  1.94592440,  3.11656427]], device='cuda:0')
Worst class: (+ rhs) -0.08838891983032227
Split layers:
  BoundConv(name=/input.8, inputs=[/28, /17, /18]): [(BoundRelu(name=/30, inputs=[/input.8]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /13, /14]): [(BoundRelu(name=/26, inputs=[/input]), 0)]
  BoundConv(name=/input.4, inputs=[/26, /15, /16]): [(BoundRelu(name=/28, inputs=[/input.4]), 0)]
  BoundLinear(name=/input.16, inputs=[/33, /21, /22]): [(BoundRelu(name=/35, inputs=[/input.16]), 0)]
  BoundConv(name=/input.12, inputs=[/30, /19, /20]): [(BoundRelu(name=/32, inputs=[/input.12]), 0)]
Total VNNLIB file length: 9, max property batch size: 1, total number of batches: 9
lA shape: [torch.Size([1, 9, 8, 16, 16]), torch.Size([1, 9, 8, 16, 16]), torch.Size([1, 9, 8, 16, 16]), torch.Size([1, 9, 8, 8, 8]), torch.Size([1, 9, 100])]

Properties batch 0, size 1
Remaining timeout: 697.1470348834991
##### Instance 0 first 10 spec matrices: 
tensor([[[-1.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Remaining spec index [0] with bounds tensor([[-0.08838892]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/13): BoundParams(name=/13, inputs=[])
  (/14): BoundParams(name=/14, inputs=[])
  (/15): BoundParams(name=/15, inputs=[])
  (/16): BoundParams(name=/16, inputs=[])
  (/17): BoundParams(name=/17, inputs=[])
  (/18): BoundParams(name=/18, inputs=[])
  (/19): BoundParams(name=/19, inputs=[])
  (/20): BoundParams(name=/20, inputs=[])
  (/21): BoundParams(name=/21, inputs=[])
  (/22): BoundParams(name=/22, inputs=[])
  (/23): BoundParams(name=/23, inputs=[])
  (/24): BoundParams(name=/24, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /13, /14])
  (/26): BoundRelu(name=/26, inputs=[/input])
  (/input.4): BoundConv(name=/input.4, inputs=[/26, /15, /16])
  (/28): BoundRelu(name=/28, inputs=[/input.4])
  (/input.8): BoundConv(name=/input.8, inputs=[/28, /17, /18])
  (/30): BoundRelu(name=/30, inputs=[/input.8])
  (/input.12): BoundConv(name=/input.12, inputs=[/30, /19, /20])
  (/32): BoundRelu(name=/32, inputs=[/input.12])
  (/33): BoundFlatten(name=/33, inputs=[/32])
  (/input.16): BoundLinear(name=/input.16, inputs=[/33, /21, /22])
  (/35): BoundRelu(name=/35, inputs=[/input.16])
  (/36): BoundLinear(name=/36, inputs=[/35, /23, /24])
)
Model prediction is: tensor([ 2.12422514, -2.56402445,  2.55647516,  0.29432344,  0.60963291,
         0.24455148, -1.61683786,  0.23884836, -0.38029242, -1.50684512],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /26 start_node /36 with alignment adjustment
setting alpha for layer /28 start_node /36 with alignment adjustment
setting alpha for layer /30 start_node /36 with alignment adjustment
setting alpha for layer /32 start_node /36 with alignment adjustment
setting alpha for layer /35 start_node /36 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 8, 16, 16]), torch.Size([1, 1, 8, 16, 16]), torch.Size([1, 1, 8, 16, 16]), torch.Size([1, 1, 8, 8, 8]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.08838892]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input.8,/input,/input.4,/input.16,/input.12,/36
Split layers:
  BoundLinear(name=/input.16, inputs=[/33, /21, /22]): [(BoundRelu(name=/35, inputs=[/input.16]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /13, /14]): [(BoundRelu(name=/26, inputs=[/input]), 0)]
  BoundConv(name=/input.4, inputs=[/26, /15, /16]): [(BoundRelu(name=/28, inputs=[/input.4]), 0)]
  BoundConv(name=/input.12, inputs=[/30, /19, /20]): [(BoundRelu(name=/32, inputs=[/input.12]), 0)]
  BoundConv(name=/input.8, inputs=[/28, /17, /18]): [(BoundRelu(name=/30, inputs=[/input.8]), 0)]
Keeping slopes for these layers: ['/36']
Keeping slopes for these layers: ['/36']
Node /26 input 0: size torch.Size([8, 16, 16]) unstable 90
Node /28 input 0: size torch.Size([8, 16, 16]) unstable 126
Node /30 input 0: size torch.Size([8, 16, 16]) unstable 186
Node /32 input 0: size torch.Size([8, 8, 8]) unstable 30
Node /35 input 0: size torch.Size([100]) unstable 22
-----------------
# of unstable neurons: 454
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.16, 4] 
split level 1: [/input.16, 58] 
split level 2: [/input.16, 0] 
split level 3: [/input.16, 44] 
pruning_in_iteration open status: True
ratio of positive domain = 14 / 16 = 0.875
pruning-in-iteration extra time: 0.05344653129577637
Time: prepare 0.0032    beta_bound 2.0197    bound 2.0198    transfer 0.0010    finalize 0.0024    func 2.0264    
Accumulated time: func 2.0264    prepare 0.0058    bound 2.0198    beta_bound 2.0197    transfer 0.0010    finalize 0.0024    
batch bounding time:  2.0265891551971436
Current worst splitting domains lb-rhs (depth):
-0.03987 (4), -0.02186 (4), 
length of domains: 2
Time: pickout 0.0022    decision 0.7061    set_bounds 0.0022    solve 2.0266    add 0.0022    
Accumulated time: pickout 0.0022    decision 0.7061    set_bounds 0.0022    solve 2.0266    add 0.0022    
Current (lb-rhs): -0.039870500564575195
2 domains visited
Cumulative time: 2.853301763534546

BaB round 2
batch: 2
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.12, 497] [/input.12, 497] 
split level 1: [/input.16, 34] [/input.16, 34] 
split level 2: [/input.16, 99] [/input.16, 99] 
pruning_in_iteration open status: True
ratio of positive domain = 13 / 16 = 0.8125
pruning-in-iteration extra time: 0.055444955825805664
Time: prepare 0.0043    beta_bound 1.4422    bound 1.4423    transfer 0.0010    finalize 0.0024    func 1.4501    
Accumulated time: func 3.4765    prepare 0.0129    bound 3.4621    beta_bound 3.4619    transfer 0.0019    finalize 0.0047    
batch bounding time:  1.4503068923950195
Current worst splitting domains lb-rhs (depth):
-0.02653 (7), -0.00780 (7), -0.00107 (7), 
length of domains: 3
Time: pickout 0.0021    decision 0.1475    set_bounds 0.0022    solve 1.4503    add 0.0018    
Accumulated time: pickout 0.0043    decision 0.8536    set_bounds 0.0044    solve 3.4769    add 0.0040    
Current (lb-rhs): -0.02652883529663086
5 domains visited
Cumulative time: 4.457837343215942

BaB round 3
batch: 3
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.16, 81] [/input.16, 81] [/input.16, 81] 
split level 1: [/input.16, 33] [/input.16, 33] [/input.16, 33] 
pruning_in_iteration open status: True
ratio of positive domain = 10 / 12 = 0.8333333333333334
pruning-in-iteration extra time: 0.05186295509338379
Time: prepare 0.0034    beta_bound 1.4590    bound 1.4592    transfer 0.0008    finalize 0.0020    func 1.4654    
Accumulated time: func 4.9420    prepare 0.0189    bound 4.9213    beta_bound 4.9209    transfer 0.0027    finalize 0.0067    
batch bounding time:  1.465566635131836
Current worst splitting domains lb-rhs (depth):
-0.02241 (9), -0.00297 (9), 
length of domains: 2
Time: pickout 0.0019    decision 0.1450    set_bounds 0.0021    solve 1.4656    add 0.0016    
Accumulated time: pickout 0.0062    decision 0.9986    set_bounds 0.0065    solve 4.9425    add 0.0056    
Current (lb-rhs): -0.022412776947021484
7 domains visited
Cumulative time: 6.07470440864563

BaB round 4
batch: 2
Average branched neurons at iteration 4:  1.0000
splitting decisions: 
split level 0: [/input, 1622] [/input, 1622] 
split level 1: [/input.8, 69] [/input.8, 69] 
split level 2: [/input.12, 187] [/input.12, 187] 
pruning_in_iteration open status: True
ratio of positive domain = 10 / 16 = 0.625
pruning-in-iteration extra time: 0.05215001106262207
Time: prepare 0.0045    beta_bound 1.3859    bound 1.3860    transfer 0.0006    finalize 0.0036    func 1.3948    
Accumulated time: func 6.3368    prepare 0.0261    bound 6.3073    beta_bound 6.3068    transfer 0.0033    finalize 0.0103    
batch bounding time:  1.395007610321045
Current worst splitting domains lb-rhs (depth):
-0.01851 (12), -0.01425 (12), -0.00877 (12), -0.00453 (12), -0.00432 (12), -0.00007 (12), 
length of domains: 6
Time: pickout 0.0015    decision 0.1372    set_bounds 0.0015    solve 1.3950    add 0.0026    
Accumulated time: pickout 0.0077    decision 1.1358    set_bounds 0.0080    solve 6.3376    add 0.0082    
Current (lb-rhs): -0.018507003784179688
13 domains visited
Cumulative time: 7.613370180130005

BaB round 5
batch: 6
Average branched neurons at iteration 5:  1.0000
splitting decisions: 
split level 0: [/input.16, 8] [/input.16, 8] [/input.16, 8] [/input.16, 8] [/input.16, 8] [/input.16, 8] 
pruning_in_iteration open status: True
ratio of positive domain = 5 / 12 = 0.41666666666666663
pruning-in-iteration extra time: 0.05282163619995117
Time: prepare 0.0035    beta_bound 1.4402    bound 1.4403    transfer 0.0010    finalize 0.0028    func 1.4477    
Accumulated time: func 7.7845    prepare 0.0321    bound 7.7476    beta_bound 7.7470    transfer 0.0044    finalize 0.0131    
batch bounding time:  1.4477956295013428
Current worst splitting domains lb-rhs (depth):
-0.01419 (13), -0.01245 (13), -0.00977 (13), -0.00755 (13), -0.00446 (13), -0.00263 (13), -0.00004 (13), 
length of domains: 7
Time: pickout 0.0024    decision 0.1339    set_bounds 0.0014    solve 1.4478    add 0.0015    
Accumulated time: pickout 0.0101    decision 1.2696    set_bounds 0.0094    solve 7.7854    add 0.0097    
Current (lb-rhs): -0.014186382293701172
20 domains visited
Cumulative time: 9.200749397277832

BaB round 6
batch: 7
Average branched neurons at iteration 6:  1.0000
splitting decisions: 
split level 0: [/input.12, 438] [/input.12, 438] [/input.12, 438] [/input.12, 438] [/input.12, 438] [/input.12, 438] [/input.12, 438] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 14 = 0.5714285714285714
pruning-in-iteration extra time: 0.05009269714355469
Time: prepare 0.0051    beta_bound 1.4153    bound 1.4155    transfer 0.0010    finalize 0.0029    func 1.4245    
Accumulated time: func 9.2090    prepare 0.0398    bound 9.1631    beta_bound 9.1623    transfer 0.0054    finalize 0.0160    
batch bounding time:  1.4246513843536377
Current worst splitting domains lb-rhs (depth):
-0.01325 (14), -0.01141 (14), -0.00884 (14), -0.00650 (14), -0.00353 (14), -0.00159 (14), 
length of domains: 6
Time: pickout 0.0012    decision 0.1437    set_bounds 0.0017    solve 1.4247    add 0.0020    
Accumulated time: pickout 0.0113    decision 1.4134    set_bounds 0.0111    solve 9.2101    add 0.0117    
Current (lb-rhs): -0.013253927230834961
26 domains visited
Cumulative time: 10.774754285812378

BaB round 7
batch: 6
Average branched neurons at iteration 7:  1.0000
splitting decisions: 
split level 0: [/input.12, 481] [/input.12, 481] [/input.12, 481] [/input.12, 481] [/input.12, 481] [/input.12, 481] 
pruning_in_iteration open status: True
ratio of positive domain = 4 / 12 = 0.33333333333333337
pruning-in-iteration extra time: 0.042684078216552734
Time: prepare 0.0036    beta_bound 1.3067    bound 1.3068    transfer 0.0008    finalize 0.0024    func 1.3137    
Accumulated time: func 10.5227    prepare 0.0459    bound 10.4699    beta_bound 10.4690    transfer 0.0062    finalize 0.0184    
batch bounding time:  1.3137874603271484
Current worst splitting domains lb-rhs (depth):
-0.01240 (15), -0.01049 (15), -0.00799 (15), -0.00557 (15), -0.00333 (15), -0.00268 (15), -0.00144 (15), -0.00067 (15), 
length of domains: 8
Time: pickout 0.0018    decision 0.1317    set_bounds 0.0014    solve 1.3138    add 0.0021    
Accumulated time: pickout 0.0130    decision 1.5450    set_bounds 0.0124    solve 10.5239    add 0.0138    
Current (lb-rhs): -0.012398481369018555
34 domains visited
Cumulative time: 12.226207971572876

BaB round 8
batch: 8
Average branched neurons at iteration 8:  1.0000
splitting decisions: 
split level 0: [/input.12, 110] [/input.12, 110] [/input.12, 110] [/input.12, 110] [/input.12, 110] [/input.12, 110] [/input.12, 110] [/input.12, 498] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 16 = 0.5
pruning-in-iteration extra time: 0.04531526565551758
Time: prepare 0.0026    beta_bound 1.3188    bound 1.3189    transfer 0.0007    finalize 0.0021    func 1.3242    
Accumulated time: func 11.8469    prepare 0.0507    bound 11.7888    beta_bound 11.7878    transfer 0.0068    finalize 0.0205    
batch bounding time:  1.3243608474731445
Current worst splitting domains lb-rhs (depth):
-0.01167 (16), -0.00977 (16), -0.00505 (16), -0.00495 (16), -0.00485 (16), -0.00195 (16), -0.00093 (16), -0.00019 (16), 
length of domains: 8
Time: pickout 0.0022    decision 0.1204    set_bounds 0.0009    solve 1.3244    add 0.0019    
Accumulated time: pickout 0.0153    decision 1.6655    set_bounds 0.0133    solve 11.8483    add 0.0157    
Current (lb-rhs): -0.011674880981445312
42 domains visited
Cumulative time: 13.676621198654175

BaB round 9
batch: 8
Average branched neurons at iteration 9:  1.0000
splitting decisions: 
split level 0: [/input.12, 498] [/input.12, 498] [/input.12, 498] [/input.12, 498] [/input.12, 498] [/input.12, 110] [/input.16, 2] [/input.12, 110] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 16 = 0.5
pruning-in-iteration extra time: 0.04570341110229492
Time: prepare 0.0050    beta_bound 1.3159    bound 1.3160    transfer 0.0010    finalize 0.0028    func 1.3250    
Accumulated time: func 13.1719    prepare 0.0583    bound 13.1048    beta_bound 13.1037    transfer 0.0079    finalize 0.0233    
batch bounding time:  1.3251121044158936
Current worst splitting domains lb-rhs (depth):
-0.00874 (17), -0.00860 (17), -0.00697 (17), -0.00672 (17), -0.00434 (17), -0.00423 (17), -0.00214 (17), -0.00183 (17), 
length of domains: 8
Time: pickout 0.0018    decision 0.1309    set_bounds 0.0017    solve 1.3251    add 0.0020    
Accumulated time: pickout 0.0171    decision 1.7964    set_bounds 0.0150    solve 13.1734    add 0.0177    
Current (lb-rhs): -0.008739948272705078
50 domains visited
Cumulative time: 15.139039516448975

BaB round 10
batch: 8
Average branched neurons at iteration 10:  1.0000
splitting decisions: 
split level 0: [/input.12, 274] [/input.12, 274] [/input.16, 2] [/input.12, 274] [/input.12, 274] [/input.12, 274] [/input.12, 274] [/input.16, 2] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 16 = 0.5
pruning-in-iteration extra time: 0.05139803886413574
Time: prepare 0.0054    beta_bound 1.4010    bound 1.4011    transfer 0.0006    finalize 0.0021    func 1.4094    
Accumulated time: func 14.5812    prepare 0.0663    bound 14.5059    beta_bound 14.5047    transfer 0.0085    finalize 0.0254    
batch bounding time:  1.4094672203063965
Current worst splitting domains lb-rhs (depth):
-0.00795 (18), -0.00782 (18), -0.00626 (18), -0.00602 (18), -0.00367 (18), -0.00357 (18), -0.00143 (18), -0.00112 (18), 
length of domains: 8
Time: pickout 0.0019    decision 0.1462    set_bounds 0.0020    solve 1.4095    add 0.0014    
Accumulated time: pickout 0.0189    decision 1.9426    set_bounds 0.0171    solve 14.5829    add 0.0191    
Current (lb-rhs): -0.00795435905456543
58 domains visited
Cumulative time: 16.70059370994568

BaB round 11
batch: 8
Average branched neurons at iteration 11:  1.0000
splitting decisions: 
split level 0: [/input.16, 2] [/input.4, 662] [/input.12, 274] [/input.16, 2] [/input.16, 2] [/input.16, 2] [/input.4, 662] [/input.12, 274] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 16 = 0.5
pruning-in-iteration extra time: 0.0495295524597168
Time: prepare 0.0033    beta_bound 1.4321    bound 1.4322    transfer 0.0010    finalize 0.0029    func 1.4395    
Accumulated time: func 16.0208    prepare 0.0721    bound 15.9381    beta_bound 15.9368    transfer 0.0095    finalize 0.0284    
batch bounding time:  1.4396770000457764
Current worst splitting domains lb-rhs (depth):
-0.00729 (19), -0.00716 (19), -0.00547 (19), -0.00524 (19), -0.00289 (19), -0.00280 (19), -0.00098 (19), -0.00066 (19), 
length of domains: 8
Time: pickout 0.0019    decision 0.1507    set_bounds 0.0018    solve 1.4397    add 0.0019    
Accumulated time: pickout 0.0208    decision 2.0933    set_bounds 0.0189    solve 16.0226    add 0.0210    
Current (lb-rhs): -0.00729060173034668
66 domains visited
Cumulative time: 18.297297716140747

BaB round 12
batch: 8
Average branched neurons at iteration 12:  1.0000
splitting decisions: 
split level 0: [/input.4, 662] [/input.16, 2] [/input.4, 662] [/input.4, 662] [/input.4, 662] [/input.4, 662] [/input.16, 2] [/input.4, 662] 
pruning_in_iteration open status: True
ratio of positive domain = 5 / 16 = 0.3125
pruning-in-iteration extra time: 0.0447995662689209
Time: prepare 0.0043    beta_bound 1.4399    bound 1.4400    transfer 0.0010    finalize 0.0032    func 1.4486    
Accumulated time: func 17.4693    prepare 0.0790    bound 17.3782    beta_bound 17.3767    transfer 0.0106    finalize 0.0315    
batch bounding time:  1.4487254619598389
Current worst splitting domains lb-rhs (depth):
-0.00684 (20), -0.00671 (20), -0.00502 (20), -0.00478 (20), -0.00399 (20), -0.00388 (20), -0.00257 (20), -0.00244 (20), -0.00244 (20), -0.00235 (20), -0.00017 (20), 
length of domains: 11
Time: pickout 0.0015    decision 0.1421    set_bounds 0.0014    solve 1.4488    add 0.0023    
Accumulated time: pickout 0.0224    decision 2.2355    set_bounds 0.0203    solve 17.4714    add 0.0233    
Current (lb-rhs): -0.006838321685791016
77 domains visited
Cumulative time: 19.894184350967407

BaB round 13
batch: 11
Average branched neurons at iteration 13:  1.0000
splitting decisions: 
split level 0: [/input.12, 386] [/input.12, 386] [/input.8, 1492] [/input.8, 1492] [/input.8, 1492] [/input.12, 386] [/input.8, 1492] [/input.8, 1492] [/input.8, 1492] [/input.8, 1493] 
pruning_in_iteration open status: True
ratio of positive domain = 7 / 22 = 0.31818181818181823
pruning-in-iteration extra time: 0.04408740997314453
Time: prepare 0.0057    beta_bound 1.3986    bound 1.3988    transfer 0.0009    finalize 0.0049    func 1.4103    
Accumulated time: func 18.8797    prepare 0.0875    bound 18.7769    beta_bound 18.7753    transfer 0.0114    finalize 0.0364    
batch bounding time:  1.4104516506195068
Current worst splitting domains lb-rhs (depth):
-0.00598 (21), -0.00559 (21), -0.00415 (21), -0.00384 (21), -0.00376 (21), -0.00303 (21), -0.00260 (21), -0.00227 (21), -0.00213 (21), -0.00132 (21), -0.00125 (21), -0.00121 (21), -0.00116 (21), -0.00115 (21), -0.00114 (21), 
length of domains: 15
Time: pickout 0.0018    decision 0.1563    set_bounds 0.0018    solve 1.4105    add 0.0020    
Accumulated time: pickout 0.0241    decision 2.3917    set_bounds 0.0221    solve 18.8818    add 0.0252    
Current (lb-rhs): -0.005979061126708984
92 domains visited
Cumulative time: 21.46695041656494

BaB round 14
batch: 15
Average branched neurons at iteration 14:  1.0000
splitting decisions: 
split level 0: [/input.8, 1492] [/input.8, 177] [/input.12, 386] [/input.12, 386] [/input.8, 177] [/input.12, 386] [/input.12, 386] [/input.12, 386] [/input.12, 386] [/input.12, 386] 
pruning_in_iteration open status: True
ratio of positive domain = 14 / 30 = 0.4666666666666667
pruning-in-iteration extra time: 0.049057960510253906
Time: prepare 0.0044    beta_bound 1.4353    bound 1.4355    transfer 0.0014    finalize 0.0054    func 1.4467    
Accumulated time: func 20.3264    prepare 0.0945    bound 20.2124    beta_bound 20.2107    transfer 0.0129    finalize 0.0418    
batch bounding time:  1.4468443393707275
Current worst splitting domains lb-rhs (depth):
-0.00515 (22), -0.00485 (22), -0.00339 (22), -0.00313 (22), -0.00285 (22), -0.00276 (22), -0.00205 (22), -0.00172 (22), -0.00128 (22), -0.00112 (22), -0.00032 (22), -0.00026 (22), -0.00011 (22), -0.00006 (22), -0.00004 (22), -0.00002 (22), 
length of domains: 16
Time: pickout 0.0014    decision 0.1363    set_bounds 0.0011    solve 1.4469    add 0.0018    
Accumulated time: pickout 0.0256    decision 2.5281    set_bounds 0.0231    solve 20.3287    add 0.0270    
Current (lb-rhs): -0.0051457881927490234
108 domains visited
Cumulative time: 23.054949283599854

BaB round 15
batch: 16
Average branched neurons at iteration 15:  1.0000
splitting decisions: 
split level 0: [/input.8, 1980] [/input.8, 1980] [/input.8, 1980] [/input.8, 1980] [/input.8, 177] [/input.8, 177] [/input.8, 1493] [/input.8, 177] [/input.8, 1493] [/input.12, 385] 
pruning_in_iteration open status: True
ratio of positive domain = 19 / 32 = 0.59375
pruning-in-iteration extra time: 0.04620528221130371
Time: prepare 0.0087    beta_bound 1.3835    bound 1.3836    transfer 0.0010    finalize 0.0054    func 1.3987    
Accumulated time: func 21.7251    prepare 0.1057    bound 21.5960    beta_bound 21.5942    transfer 0.0138    finalize 0.0472    
batch bounding time:  1.398850917816162
Current worst splitting domains lb-rhs (depth):
-0.00403 (23), -0.00348 (23), -0.00300 (23), -0.00252 (23), -0.00208 (23), -0.00201 (23), -0.00192 (23), -0.00149 (23), -0.00101 (23), -0.00082 (23), -0.00045 (23), -0.00044 (23), -0.00028 (23), 
length of domains: 13
Time: pickout 0.0012    decision 0.1416    set_bounds 0.0023    solve 1.3989    add 0.0022    
Accumulated time: pickout 0.0268    decision 2.6696    set_bounds 0.0254    solve 21.7276    add 0.0292    
Current (lb-rhs): -0.004029512405395508
121 domains visited
Cumulative time: 24.60175061225891

BaB round 16
batch: 13
Average branched neurons at iteration 16:  1.0000
splitting decisions: 
split level 0: [/input.8, 1515] [/input.8, 1515] [/input.8, 1980] [/input.8, 1980] [/input.8, 1980] [/input.8, 1980] [/input.8, 1515] [/input.8, 1492] [/input.8, 1980] [/input.8, 1980] 
pruning_in_iteration open status: True
ratio of positive domain = 13 / 26 = 0.5
pruning-in-iteration extra time: 0.04936552047729492
Time: prepare 0.0057    beta_bound 1.3812    bound 1.3814    transfer 0.0013    finalize 0.0050    func 1.3933    
Accumulated time: func 23.1184    prepare 0.1138    bound 22.9774    beta_bound 22.9754    transfer 0.0151    finalize 0.0521    
batch bounding time:  1.3934071063995361
Current worst splitting domains lb-rhs (depth):
-0.00258 (24)/home/zhouxingshi/miniconda3/envs/alpha-beta-crown/lib/python3.7/site-packages/onnx2pytorch/convert/layer.py:30: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1646755953518/work/torch/csrc/utils/tensor_numpy.cpp:178.)
  layer.weight.data = torch.from_numpy(numpy_helper.to_array(weight))
/home/zhouxingshi/miniconda3/envs/alpha-beta-crown/lib/python3.7/site-packages/onnx2pytorch/convert/model.py:154: UserWarning: Using experimental implementation that allows 'batch_size > 1'.Batchnorm layers could potentially produce false outputs.
  "Using experimental implementation that allows 'batch_size > 1'."
, -0.00236 (24), -0.00188 (24), -0.00175 (24), -0.00125 (24), -0.00116 (24), -0.00085 (24), -0.00068 (24), -0.00061 (24), -0.00048 (24), -0.00037 (24), -0.00022 (24), -0.00012 (24), 
length of domains: 13
Time: pickout 0.0016    decision 0.1292    set_bounds 0.0014    solve 1.3934    add 0.0017    
Accumulated time: pickout 0.0284    decision 2.7989    set_bounds 0.0268    solve 23.1210    add 0.0308    
Current (lb-rhs): -0.0025844573974609375
134 domains visited
Cumulative time: 26.129703044891357

BaB round 17
batch: 13
Average branched neurons at iteration 17:  1.0000
splitting decisions: 
split level 0: [/input.8, 1514] [/input.8, 1515] [/input.8, 1515] [/input.8, 1514] [/input.8, 1515] [/input.8, 1515] [/input.8, 1980] [/input.8, 1515] [/input.8, 1514] [/input.8, 1492] 
pruning_in_iteration open status: True
ratio of positive domain = 20 / 26 = 0.7692307692307692
pruning-in-iteration extra time: 0.04750943183898926
Time: prepare 0.0072    beta_bound 1.3457    bound 1.3459    transfer 0.0012    finalize 0.0049    func 1.3593    
Accumulated time: func 24.4777    prepare 0.1232    bound 24.3232    beta_bound 24.3212    transfer 0.0163    finalize 0.0570    
batch bounding time:  1.3594884872436523
Current worst splitting domains lb-rhs (depth):
-0.00174 (25), -0.00147 (25), -0.00098 (25), -0.00085 (25), -0.00023 (25), -0.00005 (25), 
length of domains: 6
Time: pickout 0.0011    decision 0.1277    set_bounds 0.0009    solve 1.3595    add 0.0019    
Accumulated time: pickout 0.0295    decision 2.9266    set_bounds 0.0278    solve 24.4805    add 0.0327    
Current (lb-rhs): -0.001744985580444336
140 domains visited
Cumulative time: 27.621715545654297

BaB round 18
batch: 6
Average branched neurons at iteration 18:  1.0000
splitting decisions: 
split level 0: [/input.8, 1435] [/input.8, 1435] [/input.8, 1435] [/input.8, 1435] [/input.8, 1435] [/input.8, 1435] 
pruning_in_iteration open status: True
ratio of positive domain = 8 / 12 = 0.6666666666666667
pruning-in-iteration extra time: 0.011594295501708984
Time: prepare 0.0031    beta_bound 0.3152    bound 0.3153    transfer 0.0012    finalize 0.0027    func 0.3223    
Accumulated time: func 24.8001    prepare 0.1285    bound 24.6385    beta_bound 24.6363    transfer 0.0175    finalize 0.0598    
batch bounding time:  0.3224453926086426
Current worst splitting domains lb-rhs (depth):
-0.00127 (26), -0.00099 (26), -0.00052 (26), -0.00040 (26), 
length of domains: 4
Time: pickout 0.0017    decision 0.1176    set_bounds 0.0012    solve 0.3225    add 0.0013    
Accumulated time: pickout 0.0313    decision 3.0442    set_bounds 0.0290    solve 24.8030    add 0.0340    
Current (lb-rhs): -0.001272439956665039
144 domains visited
Cumulative time: 28.066561698913574

BaB round 19
batch: 4
Average branched neurons at iteration 19:  1.0000
splitting decisions: 
split level 0: [/input.8, 1492] [/input.8, 1514] [/input.8, 1514] [/input.8, 1514] 
split level 1: [/input.12, 104] [/input.12, 104] [/input.12, 104] [/input.8, 1979] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 16 / 16 = 1.0
pruning-in-iteration extra time: 9.393692016601562e-05
Time: prepare 0.0054    beta_bound 0.0154    bound 0.0155    transfer 0.0004    finalize 0.0023    func 0.0236    
Accumulated time: func 24.8237    prepare 0.1364    bound 24.6541    beta_bound 24.6517    transfer 0.0179    finalize 0.0621    
batch bounding time:  0.023732900619506836
length of domains: 0
Time: pickout 0.0011    decision 0.1279    set_bounds 0.0023    solve 0.0238    add 0.0001    
Accumulated time: pickout 0.0324    decision 3.1721    set_bounds 0.0313    solve 24.8268    add 0.0341    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
144 domains visited
Cumulative time: 28.222286462783813


Properties batch 1, size 1
Remaining timeout: 668.6205730438232
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0., -1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 4.00974178314209.

Properties batch 2, size 1
Remaining timeout: 668.505273103714
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1., -1.,  0.,  0.,  0.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.6550085544586182.

Properties batch 3, size 1
Remaining timeout: 668.4343144893646
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0., -1.,  0.,  0.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.4772083759307861.

Properties batch 4, size 1
Remaining timeout: 668.3557560443878
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0.,  0., -1.,  0.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.623123288154602.

Properties batch 5, size 1
Remaining timeout: 668.2764267921448
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0.,  0.,  0., -1.,  0.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 3.4944636821746826.

Properties batch 6, size 1
Remaining timeout: 668.2004978656769
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0.,  0.,  0.,  0., -1.,  0.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.4292126893997192.

Properties batch 7, size 1
Remaining timeout: 668.1190829277039
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0., -1.,  0.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.9459244012832642.

Properties batch 8, size 1
Remaining timeout: 668.0402483940125
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.,  0., -1.]]],
       dtype=torch.float64)
thresholds: [0.] ######
Initial alpha-CROWN verified for spec index [0] with bound 3.1165642738342285.
Result: safe in 52.0381 seconds
############# Summary #############
Final verified acc: 100.0% (total 1 examples)
Problem instances count: 1 , total verified (safe/unsat): 1 , total falsified (unsafe/sat): 0 , timeout: 0
mean time for ALL instances (total 1):52.037601562689815, max time: 52.038121938705444
mean time for verified SAFE instances(total 1): 52.038121938705444, max time: 52.038121938705444
safe (total 1), index: [0]
