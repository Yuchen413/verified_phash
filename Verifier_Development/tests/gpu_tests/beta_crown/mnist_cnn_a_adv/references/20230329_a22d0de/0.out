Configurations:

general:
  device: cuda
  seed: 100
  conv_mode: patches
  deterministic: false
  double_fp: false
  loss_reduction_func: sum
  sparse_alpha: true
  save_adv_example: false
  precompile_jit: false
  complete_verifier: bab
  enable_incomplete_verification: true
  csv_name: null
  results_file: out.txt
  root_path: ''
model:
  name: mnist_cnn_4layer
  path: mnist_cnn_a_adv.model
  onnx_path: null
  onnx_path_prefix: ''
  cache_onnx_conversion: false
  onnx_quirks: null
  input_shape: null
  onnx_loader: default_onnx_and_vnnlib_loader
  onnx_optimization_flags: none
data:
  start: 2
  end: 3
  select_instance: null
  num_outputs: 10
  mean: 0.0
  std: 1.0
  pkl_path: null
  dataset: MNIST_SDP
  data_filter_path: null
  data_idx_file: null
specification:
  type: lp
  robustness_type: verified-acc
  norm: .inf
  epsilon: 0.3
  epsilon_min: 0.0
  vnnlib_path: null
  vnnlib_path_prefix: ''
solver:
  batch_size: 1024
  min_batch_size_ratio: 0.1
  use_float64_in_last_iteration: false
  early_stop_patience: 10
  start_save_best: 0.5
  bound_prop_method: alpha-crown
  init_bound_prop_method: same
  prune_after_crown: false
  crown:
    batch_size: 1000000000
    max_crown_size: 1000000000
  alpha-crown:
    alpha: true
    lr_alpha: 0.1
    iteration: 100
    share_slopes: false
    no_joint_opt: false
    lr_decay: 0.98
    full_conv_alpha: true
  beta-crown:
    lr_alpha: 0.01
    lr_beta: 0.05
    lr_decay: 0.98
    optimizer: adam
    iteration: 20
    beta: true
    beta_warmup: true
    enable_opt_interm_bounds: false
    all_node_split_LP: false
  forward:
    refine: false
    dynamic: false
    max_dim: 10000
  intermediate_refinement:
    enabled: false
    batch_size: 10
    opt_coeffs: false
    opt_bias: false
    lr: 0.05
    layers: [-1]
    max_domains: 1000
  multi_class:
    label_batch_size: 32
    skip_with_refined_bound: true
  mip:
    parallel_solvers: null
    solver_threads: 1
    refine_neuron_timeout: 15
    refine_neuron_time_percentage: 0.8
    early_stop: true
    adv_warmup: true
    mip_solver: gurobi
bab:
  initial_max_domains: 1
  max_domains: .inf
  decision_thresh: 0
  timeout: 180
  timeout_scale: 1
  override_timeout: null
  get_upper_bound: false
  dfs_percent: 0.0
  pruning_in_iteration: true
  pruning_in_iteration_ratio: 0.2
  sort_targets: false
  batched_domain_list: true
  optimized_intermediate_layers: ''
  interm_transfer: true
  cut:
    enabled: false
    implication: false
    bab_cut: false
    lp_cut: false
    method: null
    lr: 0.01
    lr_decay: 1.0
    iteration: 100
    bab_iteration: -1
    early_stop_patience: -1
    lr_beta: 0.02
    number_cuts: 50
    topk_cuts_in_filter: 1000
    batch_size_primal: 100
    max_num: 1000000000
    patches_cut: false
    cplex_cuts: false
    cplex_cuts_wait: 0
    cplex_cuts_revpickup: true
    cut_reference_bounds: true
    fix_intermediate_bounds: false
    _tmp_cuts: null
    fixed_cuts: false
    add_implied_cuts: false
    add_input_cuts: false
  branching:
    method: kfsb
    candidates: 3
    reduceop: max
    sb_coeff_thresh: 0.001
    enable_intermediate_bound_opt: false
    branching_input_and_activation: false
    branching_input_and_activation_order: [input, relu]
    branching_input_iterations: 30
    branching_relu_iterations: 50
    sort_domain_interval: -1
    nonlinear_split:
      method: babsr_like
      branching_point_method: middle
      num_branches: 2
      branching_point_refinement: false
      naive_branching_score: false
      filter: false
      prioritize_mul: false
    input_split:
      enable: false
      enhanced_bound_prop_method: alpha-crown
      enhanced_branching_method: naive
      enhanced_bound_patience: 100000000.0
      attack_patience: 100000000.0
      adv_check: 0
  attack:
    enabled: false
    beam_candidates: 8
    beam_depth: 7
    max_dive_fix_ratio: 0.8
    min_local_free_ratio: 0.2
    mip_start_iteration: 5
    mip_timeout: 30.0
    adv_pool_threshold: null
    refined_mip_attacker: false
    refined_batch_size: null
attack:
  pgd_order: before
  pgd_steps: 100
  pgd_restarts: 50
  pgd_early_stop: true
  pgd_lr_decay: 0.99
  pgd_alpha: auto
  pgd_loss_mode: null
  enable_mip_attack: false
  cex_path: ./test_cex.txt
  attack_mode: PGD
  gama_lambda: 10.0
  gama_decay: 0.9
  check_clean: false
  input_split:
    pgd_steps: 100
    pgd_restarts: 30
    pgd_alpha: auto
  input_split_enhanced:
    pgd_steps: 200
    pgd_restarts: 5000000
    pgd_alpha: auto
  input_split_check_adv:
    pgd_steps: 5
    pgd_restarts: 5
    pgd_alpha: auto
debug:
  lp_test: null

Experiments at Tue Mar 28 14:52:56 2023 on zeratul
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten(start_dim=1, end_dim=-1)
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.13397828)
############################
Internal results will be saved to Verified_ret_[mnist_cnn_4layer]_start=2_end=3_iter=20_b=1024_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before_cplex_cuts=False.npy.

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0, vnnlib ID: 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Attack parameters: initialization=uniform, steps=100, restarts=50, alpha=0.07500000298023224, initialization=uniform, GAMA=False
Model output of first 5 examples:
 tensor([[-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
         -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823]],
       device='cuda:0')
Adv example prediction (first 2 examples and 2 restarts):
 tensor([[[-5.31897688, -6.17834473, -3.97109413, -3.18625212,  2.28145599,
          -2.90221286, -3.68895030, -1.58435214, -2.16368961,  3.05471182],
         [-5.31897688, -6.17834473, -3.97109413, -3.18625212,  2.28145599,
          -2.90221286, -3.68895030, -1.58435214, -2.16368961,  3.05471182]]],
       device='cuda:0')
PGD attack margin (first 2 examles and 10 specs):
 tensor([[[8.37368870, 9.23305702, 7.02580595, 6.24096394, 0.77325583,
          5.95692444, 6.74366188, 4.63906384, 5.21840143]]], device='cuda:0')
number of violation:  0
Attack finished in 1.9784 seconds.
PGD attack failed
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([[-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
         -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823]],
       device='cuda:0')
layer /input.4 using sparse-features alpha with shape [1253]; unstable size 1253; total size 3136 (torch.Size([1, 16, 14, 14]))
layer /input.4 start_node /input.8 using sparse-spec alpha with unstable size 215 total_size 1568 output_shape (32, 7, 7)
layer /input.4 start_node /input.12 using sparse-spec alpha with unstable size 32 total_size 100 output_shape torch.Size([100])
layer /input.4 start_node /16 using full alpha with unstable size None total_size 9 output_shape 9
layer /12 using sparse-features alpha with shape [215]; unstable size 215; total size 1568 (torch.Size([1, 32, 7, 7]))
layer /12 start_node /input.12 using sparse-spec alpha with unstable size 32 total_size 100 output_shape torch.Size([100])
layer /12 start_node /16 using full alpha with unstable size None total_size 9 output_shape 9
layer /15 using sparse-features alpha with shape [32]; unstable size 32; total size 100 (torch.Size([1, 100]))
layer /15 start_node /16 using full alpha with unstable size None total_size 9 output_shape 9
Optimizable variables initialized.
initial CROWN bounds: tensor([[-4.13440514, -3.38970995, -5.10830688, -5.27857780, -1.55458498,
         -6.75541544, -6.69561052, -4.95646572, -4.35540199]], device='cuda:0') None
best_l after optimization: -21.147361755371094
alpha/beta optimization time: 5.640036106109619
initial alpha-CROWN bounds: tensor([[-1.58136463, -0.55232906, -2.50153780, -2.61712670, -0.84469545,
         -3.68044019, -3.41780758, -3.44438887, -2.50767064]], device='cuda:0')
Worst class: (+ rhs) -3.6804401874542236
Split layers:
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
Total VNNLIB file length: 9, max property batch size: 1, total number of batches: 9
lA shape: [torch.Size([1, 9, 16, 14, 14]), torch.Size([1, 9, 32, 7, 7]), torch.Size([1, 9, 100])]

Properties batch 0, size 1
Remaining timeout: 166.15172815322876
##### Instance 0 first 10 spec matrices: 
tensor([[[-1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-1.58136463]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-1.58136463]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 22] 
split level 1: [/input.12, 83] 
split level 2: [/input.12, 67] 
split level 3: [/input.8, 563] 
split level 4: [/input.12, 85] 
split level 5: [/input.12, 41] 

all verified at 2th iter
pruning_in_iteration open status: True
ratio of positive domain = 64 / 64 = 1.0
pruning-in-iteration extra time: 0.0014235973358154297
Time: prepare 0.0037    beta_bound 0.4786    bound 0.4787    transfer 0.0007    finalize 0.0041    func 0.4873    
Accumulated time: func 0.4873    prepare 0.0048    bound 0.4787    beta_bound 0.4786    transfer 0.0007    finalize 0.0041    
batch bounding time:  0.48755550384521484
length of domains: 0
Time: pickout 0.0010    decision 0.4286    set_bounds 0.0029    solve 0.4876    add 0.0003    
Accumulated time: pickout 0.0010    decision 0.4286    set_bounds 0.0029    solve 0.4876    add 0.0003    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
0 domains visited
Cumulative time: 1.001448154449463


Properties batch 1, size 1
Remaining timeout: 165.01663899421692
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0., -1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-0.55232906]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.55232906]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 47] 
split level 1: [/input.12, 67] 
split level 2: [/input.12, 79] 
split level 3: [/input.12, 78] 
split level 4: [/input.8, 655] 
split level 5: [/input.12, 41] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 64 / 64 = 1.0
pruning-in-iteration extra time: 8.7738037109375e-05
Time: prepare 0.0037    beta_bound 0.0109    bound 0.0109    transfer 0.0005    finalize 0.0040    func 0.0192    
Accumulated time: func 0.0192    prepare 0.0046    bound 0.0109    beta_bound 0.0109    transfer 0.0005    finalize 0.0040    
batch bounding time:  0.01939082145690918
length of domains: 0
Time: pickout 0.0007    decision 0.0338    set_bounds 0.0017    solve 0.0194    add 0.0002    
Accumulated time: pickout 0.0007    decision 0.0338    set_bounds 0.0017    solve 0.0194    add 0.0002    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
0 domains visited
Cumulative time: 0.06291818618774414


Properties batch 2, size 1
Remaining timeout: 164.83145260810852
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0., -1.,  0.,  0.,  0.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-2.50153780]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-2.50153780]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 22] 
split level 1: [/input.8, 905] 
split level 2: [/input.12, 67] 
split level 3: [/input.12, 38] 
split level 4: [/input.12, 47] 
split level 5: [/input.12, 41] 
pruning_in_iteration open status: True
ratio of positive domain = 56 / 64 = 0.875
pruning-in-iteration extra time: 0.01410365104675293
Time: prepare 0.0037    beta_bound 0.3376    bound 0.3377    transfer 0.0009    finalize 0.0059    func 0.3485    
Accumulated time: func 0.3485    prepare 0.0046    bound 0.3377    beta_bound 0.3376    transfer 0.0009    finalize 0.0059    
batch bounding time:  0.3486804962158203
Current worst splitting domains lb-rhs (depth):
-0.34097 (6), -0.29076 (6), -0.28676 (6), -0.23424 (6), -0.17125 (6), -0.14339 (6), -0.11728 (6), -0.00313 (6), 
length of domains: 8
Time: pickout 0.0007    decision 0.0335    set_bounds 0.0018    solve 0.3487    add 0.0023    
Accumulated time: pickout 0.0007    decision 0.0335    set_bounds 0.0018    solve 0.3487    add 0.0023    
Current (lb-rhs): -0.3409748077392578
8 domains visited
Cumulative time: 0.39447879791259766

BaB round 2
batch: 8
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.12, 83] [/input.12, 11] [/input.12, 83] [/input.12, 83] [/input.8, 415] [/input.12, 83] [/input.12, 83] [/input.8, 415] 
split level 1: [/input.8, 414] [/input.12, 83] [/input.8, 415] [/input.12, 11] [/input.8, 414] [/input.8, 414] [/input.12, 11] [/input.12, 83] 
split level 2: [/input.8, 612] [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.12, 83] [/input.8, 612] [/input.8, 414] [/input.8, 414] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 64 / 64 = 1.0
pruning-in-iteration extra time: 9.918212890625e-05
Time: prepare 0.0087    beta_bound 0.0096    bound 0.0097    transfer 0.0005    finalize 0.0044    func 0.0234    
Accumulated time: func 0.3719    prepare 0.0138    bound 0.3474    beta_bound 0.3473    transfer 0.0015    finalize 0.0102    
batch bounding time:  0.023464679718017578
length of domains: 0
Time: pickout 0.0012    decision 0.0284    set_bounds 0.0019    solve 0.0235    add 0.0002    
Accumulated time: pickout 0.0019    decision 0.0620    set_bounds 0.0036    solve 0.3722    add 0.0025    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
8 domains visited
Cumulative time: 0.45014524459838867


Properties batch 3, size 1
Remaining timeout: 164.25838088989258
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0., -1.,  0.,  0.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-2.61712670]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-2.61712670]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 83] 
split level 1: [/input.12, 22] 
split level 2: [/input.12, 67] 
split level 3: [/input.12, 38] 
split level 4: [/input.12, 78] 
split level 5: [/input.12, 41] 
pruning_in_iteration open status: True
ratio of positive domain = 53 / 64 = 0.828125
pruning-in-iteration extra time: 0.01457834243774414
Time: prepare 0.0036    beta_bound 0.3436    bound 0.3437    transfer 0.0011    finalize 0.0038    func 0.3523    
Accumulated time: func 0.3523    prepare 0.0044    bound 0.3437    beta_bound 0.3436    transfer 0.0011    finalize 0.0038    
batch bounding time:  0.3524355888366699
Current worst splitting domains lb-rhs (depth):
-1.00944 (6), -0.84984 (6), -0.80099 (6), -0.62300 (6), -0.38778 (6), -0.34352 (6), -0.28098 (6), -0.20735 (6), -0.14465 (6), -0.07916 (6), -0.07566 (6), 
length of domains: 11
Time: pickout 0.0007    decision 0.0334    set_bounds 0.0016    solve 0.3525    add 0.0018    
Accumulated time: pickout 0.0007    decision 0.0334    set_bounds 0.0016    solve 0.3525    add 0.0018    
Current (lb-rhs): -1.00944185256958
11 domains visited
Cumulative time: 0.3969542980194092

BaB round 2
batch: 11
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.12, 45] [/input.8, 414] [/input.8, 905] [/input.12, 85] [/input.8, 430] [/input.8, 905] [/input.12, 79] [/input.8, 415] [/input.12, 85] [/input.8, 430] 
split level 1: [/input.12, 85] [/input.12, 79] [/input.8, 415] [/input.12, 79] [/input.12, 85] [/input.12, 79] [/input.12, 85] [/input.8, 905] [/input.12, 79] [/input.12, 85] 
split level 2: [/input.12, 79] [/input.12, 85] [/input.8, 414] [/input.8, 1207] [/input.12, 79] [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.8, 1207] [/input.12, 79] 
pruning_in_iteration open status: True
ratio of positive domain = 79 / 88 = 0.8977272727272727
pruning-in-iteration extra time: 0.013124465942382812
Time: prepare 0.0106    beta_bound 0.3430    bound 0.3431    transfer 0.0009    finalize 0.0056    func 0.3603    
Accumulated time: func 0.7126    prepare 0.0156    bound 0.6868    beta_bound 0.6866    transfer 0.0019    finalize 0.0094    
batch bounding time:  0.3604257106781006
Current worst splitting domains lb-rhs (depth):
-0.43253 (9), -0.22132 (9), -0.21067 (9), -0.18614 (9), -0.11676 (9), -0.08964 (9), -0.03334 (9), -0.01509 (9), -0.01099 (9), 
length of domains: 9
Time: pickout 0.0013    decision 0.0277    set_bounds 0.0019    solve 0.3604    add 0.0013    
Accumulated time: pickout 0.0020    decision 0.0611    set_bounds 0.0035    solve 0.7129    add 0.0031    
Current (lb-rhs): -0.4325261116027832
20 domains visited
Cumulative time: 0.790219783782959

BaB round 3
batch: 9
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] 
split level 1: [/input.8, 414] [/input.8, 414] [/input.8, 430] [/input.8, 430] [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.8, 414] 
split level 2: [/input.8, 1207] [/input.8, 1207] [/input.8, 905] [/input.8, 905] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] 

all verified at 12th iter
pruning_in_iteration open status: True
ratio of positive domain = 72 / 72 = 1.0
pruning-in-iteration extra time: 0.007713794708251953
Time: prepare 0.0053    beta_bound 0.2183    bound 0.2184    transfer 0.0011    finalize 0.0073    func 0.2322    
Accumulated time: func 0.9449    prepare 0.0216    bound 0.9052    beta_bound 0.9049    transfer 0.0030    finalize 0.0168    
batch bounding time:  0.23263096809387207
length of domains: 0
Time: pickout 0.0009    decision 0.0243    set_bounds 0.0015    solve 0.2327    add 0.0002    
Accumulated time: pickout 0.0029    decision 0.0854    set_bounds 0.0050    solve 0.9456    add 0.0034    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
20 domains visited
Cumulative time: 1.0506563186645508


Properties batch 4, size 1
Remaining timeout: 163.0722074508667
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0.,  0., -1.,  0.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-0.84469545]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.84469545]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 47] 
split level 1: [/input.12, 45] 
split level 2: [/input.8, 1046] 
split level 3: [/input.12, 11] 
split level 4: [/input.8, 556] 
split level 5: [/input.8, 655] 
pruning_in_iteration open status: True
ratio of positive domain = 61 / 64 = 0.953125
pruning-in-iteration extra time: 0.013631343841552734
Time: prepare 0.0047    beta_bound 0.3434    bound 0.3434    transfer 0.0007    finalize 0.0040    func 0.3531    
Accumulated time: func 0.3531    prepare 0.0060    bound 0.3434    beta_bound 0.3434    transfer 0.0007    finalize 0.0040    
batch bounding time:  0.35320091247558594
Current worst splitting domains lb-rhs (depth):
-0.05023 (6), -0.01941 (6), -0.00145 (6), 
length of domains: 3
Time: pickout 0.0013    decision 0.0488    set_bounds 0.0036    solve 0.3532    add 0.0010    
Accumulated time: pickout 0.0013    decision 0.0488    set_bounds 0.0036    solve 0.3532    add 0.0010    
Current (lb-rhs): -0.050230979919433594
3 domains visited
Cumulative time: 0.41700005531311035

BaB round 2
batch: 3
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.8, 648] [/input.12, 33] [/input.8, 648] 
split level 1: [/input.8, 65] [/input.8, 606] [/input.8, 606] 
split level 2: [/input.8, 1038] [/input.8, 648] [/input.8, 65] 
split level 3: [/input.8, 606] [/input.8, 65] [/input.8, 1038] 
split level 4: [/input.8, 647] [/input.8, 647] [/input.8, 647] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 96 / 96 = 1.0
pruning-in-iteration extra time: 0.0001697540283203125
Time: prepare 0.0104    beta_bound 0.0122    bound 0.0123    transfer 0.0009    finalize 0.0084    func 0.0321    
Accumulated time: func 0.3852    prepare 0.0176    bound 0.3558    beta_bound 0.3556    transfer 0.0016    finalize 0.0124    
batch bounding time:  0.032212257385253906
length of domains: 0
Time: pickout 0.0011    decision 0.0451    set_bounds 0.0040    solve 0.0322    add 0.0002    
Accumulated time: pickout 0.0024    decision 0.0939    set_bounds 0.0076    solve 0.3855    add 0.0011    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
3 domains visited
Cumulative time: 0.5001392364501953


Properties batch 5, size 1
Remaining timeout: 162.3892023563385
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0.,  0.,  0., -1.,  0.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-3.68044019]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-3.68044019]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 38] 
split level 1: [/input.12, 83] 
split level 2: [/input.12, 79] 
split level 3: [/input.8, 1194] 
split level 4: [/input.12, 81] 
split level 5: [/input.12, 41] 
pruning_in_iteration open status: True
ratio of positive domain = 37 / 64 = 0.578125
pruning-in-iteration extra time: 0.017353534698486328
Time: prepare 0.0037    beta_bound 0.3868    bound 0.3869    transfer 0.0011    finalize 0.0068    func 0.3986    
Accumulated time: func 0.3986    prepare 0.0045    bound 0.3869    beta_bound 0.3868    transfer 0.0011    finalize 0.0068    
batch bounding time:  0.39873600006103516
Current worst splitting domains lb-rhs (depth):
-1.90501 (6), -1.75534 (6), -1.66149 (6), -1.63072 (6), -1.53561 (6), -1.52646 (6), -1.39924 (6), -1.29460 (6), -1.13393 (6), -1.02113 (6), -0.98098 (6), -0.96338 (6), -0.85438 (6), -0.83096 (6), -0.78604 (6), -0.68942 (6), -0.64992 (6), -0.63391 (6), -0.62311 (6), -0.54942 (6), 
length of domains: 27
Time: pickout 0.0007    decision 0.0381    set_bounds 0.0018    solve 0.3988    add 0.0018    
Accumulated time: pickout 0.0007    decision 0.0381    set_bounds 0.0018    solve 0.3988    add 0.0018    
Current (lb-rhs): -1.9050097465515137
27 domains visited
Cumulative time: 0.44835734367370605

BaB round 2
batch: 27
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.12, 85] [/input.12, 85] [/input.12, 85] [/input.8, 430] [/input.12, 85] [/input.12, 85] [/input.12, 85] [/input.12, 67] [/input.12, 85] [/input.12, 85] 
pruning_in_iteration open status: True
ratio of positive domain = 15 / 54 = 0.2777777777777778
pruning-in-iteration extra time: 0.0199887752532959
Time: prepare 0.0042    beta_bound 0.3523    bound 0.3525    transfer 0.0009    finalize 0.0052    func 0.3629    
Accumulated time: func 0.7615    prepare 0.0095    bound 0.7394    beta_bound 0.7391    transfer 0.0020    finalize 0.0119    
batch bounding time:  0.36301708221435547
Current worst splitting domains lb-rhs (depth):
-1.61319 (7), -1.58587 (7), -1.39889 (7), -1.33631 (7), -1.26894 (7), -1.24950 (7), -1.19297 (7), -1.12868 (7), -1.12452 (7), -1.07100 (7), -1.03034 (7), -0.99098 (7), -0.87969 (7), -0.86974 (7), -0.85196 (7), -0.79459 (7), -0.77263 (7), -0.72723 (7), -0.71427 (7), -0.70638 (7), 
length of domains: 39
Time: pickout 0.0010    decision 0.0310    set_bounds 0.0009    solve 0.3630    add 0.0026    
Accumulated time: pickout 0.0017    decision 0.0691    set_bounds 0.0026    solve 0.7618    add 0.0045    
Current (lb-rhs): -1.613189697265625
66 domains visited
Cumulative time: 0.8472869396209717

BaB round 3
batch: 39
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.8, 430] [/input.8, 430] [/input.12, 85] [/input.8, 430] [/input.12, 67] [/input.8, 430] [/input.8, 430] [/input.8, 430] [/input.12, 85] [/input.8, 430] 
pruning_in_iteration open status: True
ratio of positive domain = 27 / 78 = 0.34615384615384615
pruning-in-iteration extra time: 0.01586174964904785
Time: prepare 0.0061    beta_bound 0.3735    bound 0.3735    transfer 0.0008    finalize 0.0050    func 0.3855    
Accumulated time: func 1.1470    prepare 0.0160    bound 1.1129    beta_bound 1.1126    transfer 0.0028    finalize 0.0169    
batch bounding time:  0.38576507568359375
Current worst splitting domains lb-rhs (depth):
-1.48832 (8), -1.29880 (8), -1.26681 (8), -1.21140 (8), -1.11135 (8), -1.01907 (8), -1.01005 (8), -0.94513 (8), -0.94470 (8), -0.89625 (8), -0.88074 (8), -0.87540 (8), -0.87318 (8), -0.75893 (8), -0.74121 (8), -0.72797 (8), -0.65357 (8), -0.64003 (8), -0.60483 (8), -0.60408 (8), 
length of domains: 51
Time: pickout 0.0010    decision 0.0226    set_bounds 0.0011    solve 0.3858    add 0.0025    
Accumulated time: pickout 0.0027    decision 0.0917    set_bounds 0.0037    solve 1.1476    add 0.0069    
Current (lb-rhs): -1.4883198738098145
117 domains visited
Cumulative time: 1.260697841644287

BaB round 4
batch: 51
Average branched neurons at iteration 4:  1.0000
splitting decisions: 
split level 0: [/input.12, 67] [/input.8, 410] [/input.12, 67] [/input.8, 410] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.8, 410] [/input.12, 67] [/input.8, 410] 
pruning_in_iteration open status: True
ratio of positive domain = 51 / 102 = 0.5
pruning-in-iteration extra time: 0.01689910888671875
Time: prepare 0.0076    beta_bound 0.3684    bound 0.3685    transfer 0.0013    finalize 0.0108    func 0.3883    
Accumulated time: func 1.5352    prepare 0.0243    bound 1.4814    beta_bound 1.4810    transfer 0.0041    finalize 0.0277    
batch bounding time:  0.3883845806121826
Current worst splitting domains lb-rhs (depth):
-1.11101 (9), -1.10736 (9), -1.09543 (9), -1.05976 (9), -0.88237 (9), -0.85930 (9), -0.80371 (9), -0.77494 (9), -0.76256 (9), -0.70704 (9), -0.70270 (9), -0.69887 (9), -0.68923 (9), -0.65386 (9), -0.63248 (9), -0.58888 (9), -0.56095 (9), -0.55711 (9), -0.53628 (9), -0.50261 (9), 
length of domains: 51
Time: pickout 0.0011    decision 0.0467    set_bounds 0.0013    solve 0.3884    add 0.0026    
Accumulated time: pickout 0.0039    decision 0.1384    set_bounds 0.0050    solve 1.5360    add 0.0095    
Current (lb-rhs): -1.111009120941162
168 domains visited
Cumulative time: 1.701392412185669

BaB round 5
batch: 51
Average branched neurons at iteration 5:  1.0000
splitting decisions: 
split level 0: [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] [/input.12, 67] 
pruning_in_iteration open status: True
ratio of positive domain = 59 / 102 = 0.5784313725490196
pruning-in-iteration extra time: 0.013886690139770508
Time: prepare 0.0089    beta_bound 0.3672    bound 0.3673    transfer 0.0010    finalize 0.0066    func 0.3839    
Accumulated time: func 1.9192    prepare 0.0339    bound 1.8488    beta_bound 1.8482    transfer 0.0051    finalize 0.0343    
batch bounding time:  0.38405823707580566
Current worst splitting domains lb-rhs (depth):
-0.99071 (10), -0.90760 (10), -0.88313 (10), -0.76195 (10), -0.71602 (10), -0.67908 (10), -0.63236 (10), -0.61670 (10), -0.61393 (10), -0.56580 (10), -0.48347 (10), -0.47244 (10), -0.46061 (10), -0.44596 (10), -0.43260 (10), -0.38150 (10), -0.37035 (10), -0.36644 (10), -0.35396 (10), -0.33607 (10), 
length of domains: 43
Time: pickout 0.0011    decision 0.0379    set_bounds 0.0013    solve 0.3841    add 0.0033    
Accumulated time: pickout 0.0050    decision 0.1763    set_bounds 0.0063    solve 1.9201    add 0.0128    
Current (lb-rhs): -0.9907140731811523
211 domains visited
Cumulative time: 2.130260467529297

BaB round 6
batch: 43
Average branched neurons at iteration 6:  1.0000
splitting decisions: 
split level 0: [/input.12, 45] [/input.12, 45] [/input.8, 410] [/input.12, 45] [/input.12, 67] [/input.12, 47] [/input.12, 47] [/input.12, 45] [/input.12, 47] [/input.8, 410] 
pruning_in_iteration open status: True
ratio of positive domain = 51 / 86 = 0.5930232558139534
pruning-in-iteration extra time: 0.01372385025024414
Time: prepare 0.0083    beta_bound 0.3188    bound 0.3188    transfer 0.0009    finalize 0.0055    func 0.3337    
Accumulated time: func 2.2529    prepare 0.0428    bound 2.1676    beta_bound 2.1670    transfer 0.0060    finalize 0.0398    
batch bounding time:  0.33383774757385254
Current worst splitting domains lb-rhs (depth):
-0.89228 (11), -0.76418 (11), -0.73910 (11), -0.66865 (11), -0.57819 (11), -0.53931 (11), -0.52734 (11), -0.47110 (11), -0.46722 (11), -0.46105 (11), -0.36317 (11), -0.32684 (11), -0.32528 (11), -0.31364 (11), -0.28658 (11), -0.20609 (11), -0.20605 (11), -0.15089 (11), -0.14868 (11), -0.14713 (11), 
length of domains: 35
Time: pickout 0.0017    decision 0.0258    set_bounds 0.0014    solve 0.3339    add 0.0021    
Accumulated time: pickout 0.0067    decision 0.2021    set_bounds 0.0078    solve 2.2539    add 0.0149    
Current (lb-rhs): -0.8922796249389648
246 domains visited
Cumulative time: 2.4957404136657715

BaB round 7
batch: 35
Average branched neurons at iteration 7:  1.0000
splitting decisions: 
split level 0: [/input.8, 410] [/input.8, 410] [/input.8, 410] [/input.12, 45] [/input.8, 410] [/input.8, 410] [/input.12, 45] [/input.12, 45] [/input.12, 45] [/input.12, 45] 
pruning_in_iteration open status: True
ratio of positive domain = 40 / 70 = 0.5714285714285714
pruning-in-iteration extra time: 0.011774539947509766
Time: prepare 0.0054    beta_bound 0.2876    bound 0.2877    transfer 0.0008    finalize 0.0045    func 0.2985    
Accumulated time: func 2.5513    prepare 0.0487    bound 2.4553    beta_bound 2.4546    transfer 0.0067    finalize 0.0443    
batch bounding time:  0.29857683181762695
Current worst splitting domains lb-rhs (depth):
-0.61982 (12), -0.52931 (12), -0.52427 (12), -0.50807 (12), -0.48632 (12), -0.44421 (12), -0.43124 (12), -0.34195 (12), -0.33761 (12), -0.28980 (12), -0.25983 (12), -0.23527 (12), -0.21880 (12), -0.20084 (12), -0.18110 (12), -0.17608 (12), -0.13685 (12), -0.12036 (12), -0.11218 (12), -0.10443 (12), 
length of domains: 30
Time: pickout 0.0011    decision 0.0225    set_bounds 0.0010    solve 0.2986    add 0.0033    
Accumulated time: pickout 0.0078    decision 0.2246    set_bounds 0.0088    solve 2.5525    add 0.0182    
Current (lb-rhs): -0.6198153495788574
276 domains visited
Cumulative time: 2.823096752166748

BaB round 8
batch: 30
Average branched neurons at iteration 8:  1.0000
splitting decisions: 
split level 0: [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] [/input.12, 78] 
pruning_in_iteration open status: True
ratio of positive domain = 41 / 60 = 0.6833333333333333
pruning-in-iteration extra time: 0.013856172561645508
Time: prepare 0.0044    beta_bound 0.3778    bound 0.3778    transfer 0.0007    finalize 0.0038    func 0.3868    
Accumulated time: func 2.9382    prepare 0.0537    bound 2.8331    beta_bound 2.8324    transfer 0.0074    finalize 0.0481    
batch bounding time:  0.3869311809539795
Current worst splitting domains lb-rhs (depth):
-0.41348 (13), -0.39459 (13), -0.37109 (13), -0.34890 (13), -0.30797 (13), -0.30386 (13), -0.23256 (13), -0.21566 (13), -0.21342 (13), -0.20775 (13), -0.16362 (13), -0.13466 (13), -0.11543 (13), -0.11337 (13), -0.10316 (13), -0.07917 (13), -0.07484 (13), -0.03977 (13), -0.02470 (13), 
length of domains: 19
Time: pickout 0.0017    decision 0.0276    set_bounds 0.0009    solve 0.3869    add 0.0016    
Accumulated time: pickout 0.0095    decision 0.2522    set_bounds 0.0097    solve 2.9395    add 0.0197    
Current (lb-rhs): -0.4134821891784668
295 domains visited
Cumulative time: 3.242433547973633

BaB round 9
batch: 19
Average branched neurons at iteration 9:  1.0000
splitting decisions: 
split level 0: [/input.8, 263] [/input.8, 263] [/input.8, 263] [/input.8, 263] [/input.8, 414] [/input.8, 263] [/input.8, 263] [/input.8, 414] [/input.8, 263] [/input.8, 263] 
split level 1: [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.8, 414] [/input.8, 263] [/input.8, 414] [/input.8, 414] [/input.8, 263] [/input.8, 1207] [/input.8, 414] 
pruning_in_iteration open status: True
ratio of positive domain = 65 / 76 = 0.8552631578947368
pruning-in-iteration extra time: 0.013891220092773438
Time: prepare 0.0057    beta_bound 0.3336    bound 0.3337    transfer 0.0012    finalize 0.0054    func 0.3461    
Accumulated time: func 3.2842    prepare 0.0599    bound 3.1669    beta_bound 3.1660    transfer 0.0086    finalize 0.0535    
batch bounding time:  0.34635114669799805
Current worst splitting domains lb-rhs (depth):
-0.08230 (15), -0.07975 (15), -0.06948 (15), -0.06320 (15), -0.05914 (15), -0.04815 (15), -0.04188 (15), -0.03265 (15), -0.03091 (15), -0.02578 (15), -0.02262 (15), 
length of domains: 11
Time: pickout 0.0009    decision 0.0218    set_bounds 0.0014    solve 0.3464    add 0.0018    
Accumulated time: pickout 0.0104    decision 0.2740    set_bounds 0.0111    solve 3.2858    add 0.0215    
Current (lb-rhs): -0.08229875564575195
306 domains visited
Cumulative time: 3.6154654026031494

BaB round 10
batch: 11
Average branched neurons at iteration 10:  1.0000
splitting decisions: 
split level 0: [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] [/input.8, 1195] 
split level 1: [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] [/input.8, 269] 
split level 2: [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 88 / 88 = 1.0
pruning-in-iteration extra time: 0.00017881393432617188
Time: prepare 0.0076    beta_bound 0.0124    bound 0.0125    transfer 0.0009    finalize 0.0062    func 0.0273    
Accumulated time: func 3.3115    prepare 0.0682    bound 3.1794    beta_bound 3.1784    transfer 0.0095    finalize 0.0597    
batch bounding time:  0.027712583541870117
length of domains: 0
Time: pickout 0.0013    decision 0.0336    set_bounds 0.0024    solve 0.0277    add 0.0002    
Accumulated time: pickout 0.0118    decision 0.3076    set_bounds 0.0136    solve 3.3136    add 0.0217    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
306 domains visited
Cumulative time: 3.681607484817505


Properties batch 6, size 1
Remaining timeout: 158.56705951690674
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0.,  0.,  0.,  0., -1.,  0.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-3.41780758]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-3.41780758]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 47] 
split level 1: [/input.12, 79] 
split level 2: [/input.12, 67] 
split level 3: [/input.12, 41] 
split level 4: [/input.12, 38] 
split level 5: [/input.8, 410] 
pruning_in_iteration open status: True
ratio of positive domain = 48 / 64 = 0.75
pruning-in-iteration extra time: 0.015131235122680664
Time: prepare 0.0038    beta_bound 0.3764    bound 0.3765    transfer 0.0011    finalize 0.0051    func 0.3867    
Accumulated time: func 0.3867    prepare 0.0047    bound 0.3765    beta_bound 0.3764    transfer 0.0011    finalize 0.0051    
batch bounding time:  0.38677477836608887
Current worst splitting domains lb-rhs (depth):
-0.84788 (6), -0.79159 (6), -0.66331 (6), -0.55994 (6), -0.55187 (6), -0.54124 (6), -0.46782 (6), -0.46305 (6), -0.45240 (6), -0.33067 (6), -0.32951 (6), -0.28165 (6), -0.26033 (6), -0.20126 (6), -0.15396 (6), -0.10229 (6), 
length of domains: 16
Time: pickout 0.0007    decision 0.0335    set_bounds 0.0017    solve 0.3868    add 0.0015    
Accumulated time: pickout 0.0007    decision 0.0335    set_bounds 0.0017    solve 0.3868    add 0.0015    
Current (lb-rhs): -0.8478784561157227
16 domains visited
Cumulative time: 0.43112730979919434

BaB round 2
batch: 16
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] [/input.12, 83] 
split level 1: [/input.12, 85] [/input.8, 1194] [/input.12, 85] [/input.8, 1194] [/input.12, 85] [/input.8, 1194] [/input.8, 661] [/input.8, 1194] [/input.12, 85] [/input.8, 1194] 
pruning_in_iteration open status: True
ratio of positive domain = 58 / 64 = 0.90625
pruning-in-iteration extra time: 0.01384115219116211
Time: prepare 0.0088    beta_bound 0.3588    bound 0.3588    transfer 0.0007    finalize 0.0043    func 0.3728    
Accumulated time: func 0.7594    prepare 0.0141    bound 0.7353    beta_bound 0.7351    transfer 0.0018    finalize 0.0095    
batch bounding time:  0.3728780746459961
Current worst splitting domains lb-rhs (depth):
-0.18202 (8), -0.13324 (8), -0.10758 (8), -0.10117 (8), -0.08049 (8), -0.01978 (8), 
length of domains: 6
Time: pickout 0.0009    decision 0.0300    set_bounds 0.0023    solve 0.3729    add 0.0011    
Accumulated time: pickout 0.0016    decision 0.0635    set_bounds 0.0040    solve 0.7597    add 0.0026    
Current (lb-rhs): -0.18201589584350586
22 domains visited
Cumulative time: 0.8389663696289062

BaB round 3
batch: 6
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.12, 75] [/input.12, 75] [/input.12, 75] [/input.12, 75] [/input.12, 75] [/input.12, 75] 
split level 1: [/input.12, 85] [/input.12, 85] [/input.12, 85] [/input.12, 85] [/input.12, 85] [/input.12, 85] 
split level 2: [/input.8, 655] [/input.8, 655] [/input.8, 1194] [/input.8, 655] [/input.8, 1194] [/input.8, 655] 
split level 3: [/input.8, 661] [/input.8, 661] [/input.8, 655] [/input.8, 661] [/input.8, 655] [/input.8, 661] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 96 / 96 = 1.0
pruning-in-iteration extra time: 8.630752563476562e-05
Time: prepare 0.0069    beta_bound 0.0078    bound 0.0078    transfer 0.0007    finalize 0.0058    func 0.0214    
Accumulated time: func 0.7808    prepare 0.0216    bound 0.7432    beta_bound 0.7429    transfer 0.0025    finalize 0.0153    
batch bounding time:  0.02145242691040039
length of domains: 0
Time: pickout 0.0009    decision 0.0252    set_bounds 0.0018    solve 0.0215    add 0.0001    
Accumulated time: pickout 0.0025    decision 0.0887    set_bounds 0.0058    solve 0.7812    add 0.0028    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
22 domains visited
Cumulative time: 0.8890063762664795


Properties batch 7, size 1
Remaining timeout: 157.5220410823822
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0.,  0.,  0.,  0.,  0., -1.,  0.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-3.44438887]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-3.44438887]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 78] 
split level 1: [/input.12, 22] 
split level 2: [/input.12, 11] 
split level 3: [/input.12, 67] 
split level 4: [/input.8, 1052] 
split level 5: [/input.12, 38] 
pruning_in_iteration open status: True
ratio of positive domain = 44 / 64 = 0.6875
pruning-in-iteration extra time: 0.015623331069946289
Time: prepare 0.0037    beta_bound 0.3988    bound 0.3989    transfer 0.0007    finalize 0.0043    func 0.4079    
Accumulated time: func 0.4079    prepare 0.0046    bound 0.3989    beta_bound 0.3988    transfer 0.0007    finalize 0.0043    
batch bounding time:  0.4080820083618164
Current worst splitting domains lb-rhs (depth):
-1.14641 (6), -1.04272 (6), -1.02655 (6), -1.02551 (6), -0.80529 (6), -0.74768 (6), -0.70367 (6), -0.63619 (6), -0.56284 (6), -0.55623 (6), -0.53428 (6), -0.40727 (6), -0.38545 (6), -0.23123 (6), -0.22460 (6), -0.22338 (6), -0.17624 (6), -0.15386 (6), -0.03606 (6), -0.01300 (6), 
length of domains: 20
Time: pickout 0.0007    decision 0.0342    set_bounds 0.0017    solve 0.4081    add 0.0025    
Accumulated time: pickout 0.0007    decision 0.0342    set_bounds 0.0017    solve 0.4081    add 0.0025    
Current (lb-rhs): -1.1464076042175293
20 domains visited
Cumulative time: 0.45427560806274414

BaB round 2
batch: 20
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.8, 618] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 661] [/input.8, 415] [/input.8, 415] [/input.8, 618] 
split level 1: [/input.8, 1059] [/input.8, 618] [/input.8, 618] [/input.8, 905] [/input.8, 661] [/input.8, 618] [/input.8, 618] [/input.8, 905] [/input.8, 618] [/input.8, 1059] 
pruning_in_iteration open status: True
ratio of positive domain = 65 / 80 = 0.8125
pruning-in-iteration extra time: 0.013640165328979492
Time: prepare 0.0058    beta_bound 0.3508    bound 0.3508    transfer 0.0009    finalize 0.0058    func 0.3635    
Accumulated time: func 0.7715    prepare 0.0109    bound 0.7498    beta_bound 0.7496    transfer 0.0016    finalize 0.0101    
batch bounding time:  0.36360907554626465
Current worst splitting domains lb-rhs (depth):
-0.61648 (8), -0.55304 (8), -0.48646 (8), -0.44990 (8), -0.38578 (8), -0.35877 (8), -0.32046 (8), -0.28255 (8), -0.22939 (8), -0.17098 (8), -0.14784 (8), -0.12492 (8), -0.08535 (8), -0.07553 (8), -0.06429 (8), 
length of domains: 15
Time: pickout 0.0009    decision 0.0218    set_bounds 0.0013    solve 0.3636    add 0.0015    
Accumulated time: pickout 0.0016    decision 0.0560    set_bounds 0.0030    solve 0.7717    add 0.0040    
Current (lb-rhs): -0.6164789199829102
35 domains visited
Cumulative time: 0.8439381122589111

BaB round 3
batch: 15
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.8, 661] [/input.8, 618] [/input.8, 661] [/input.8, 415] [/input.8, 1059] [/input.8, 661] [/input.8, 661] [/input.8, 661] [/input.8, 415] [/input.8, 661] 
split level 1: [/input.8, 612] [/input.8, 612] [/input.8, 612] [/input.8, 80] [/input.8, 612] [/input.8, 905] [/input.8, 1059] [/input.8, 612] [/input.8, 612] [/input.8, 612] 
pruning_in_iteration open status: True
ratio of positive domain = 50 / 60 = 0.8333333333333334
pruning-in-iteration extra time: 0.01275014877319336
Time: prepare 0.0045    beta_bound 0.3148    bound 0.3149    transfer 0.0009    finalize 0.0053    func 0.3257    
Accumulated time: func 1.0971    prepare 0.0160    bound 1.0647    beta_bound 1.0644    transfer 0.0025    finalize 0.0154    
batch bounding time:  0.3258380889892578
Current worst splitting domains lb-rhs (depth):
-0.36247 (10), -0.21554 (10), -0.20203 (10), -0.16874 (10), -0.06652 (10), -0.05128 (10), -0.04731 (10), -0.03986 (10), -0.01763 (10), -0.01169 (10), 
length of domains: 10
Time: pickout 0.0017    decision 0.0231    set_bounds 0.0012    solve 0.3259    add 0.0021    
Accumulated time: pickout 0.0033    decision 0.0791    set_bounds 0.0042    solve 1.0976    add 0.0061    
Current (lb-rhs): -0.36246824264526367
45 domains visited
Cumulative time: 1.1987411975860596

BaB round 4
batch: 10
Average branched neurons at iteration 4:  1.0000
splitting decisions: 
split level 0: [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.12, 47] [/input.8, 73] [/input.12, 47] 
split level 1: [/input.8, 905] [/input.8, 1059] [/input.8, 661] [/input.8, 1059] [/input.8, 905] [/input.8, 1059] [/input.8, 1059] [/input.8, 661] [/input.8, 612] [/input.8, 1059] 
split level 2: [/input.8, 563] [/input.8, 906] [/input.8, 414] [/input.8, 906] [/input.8, 563] [/input.8, 906] [/input.8, 906] [/input.8, 414] [/input.8, 414] [/input.8, 906] 

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 80 / 80 = 1.0
pruning-in-iteration extra time: 8.845329284667969e-05
Time: prepare 0.0099    beta_bound 0.0076    bound 0.0077    transfer 0.0006    finalize 0.0062    func 0.0245    
Accumulated time: func 1.1217    prepare 0.0265    bound 1.0724    beta_bound 1.0720    transfer 0.0031    finalize 0.0216    
batch bounding time:  0.024710655212402344
length of domains: 0
Time: pickout 0.0016    decision 0.0292    set_bounds 0.0026    solve 0.0247    add 0.0002    
Accumulated time: pickout 0.0049    decision 0.1083    set_bounds 0.0068    solve 1.1223    add 0.0063    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
45 domains visited
Cumulative time: 1.2579374313354492


Properties batch 8, size 1
Remaining timeout: 156.12171912193298
##### Instance 0 first 10 spec matrices: 
tensor([[[ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., -1.,  1.]]])
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-2.50767064]], device='cuda:0') need to verify.
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[])
  (/1): BoundParams(name=/1, inputs=[])
  (/2): BoundParams(name=/2, inputs=[])
  (/3): BoundParams(name=/3, inputs=[])
  (/4): BoundParams(name=/4, inputs=[])
  (/5): BoundParams(name=/5, inputs=[])
  (/6): BoundParams(name=/6, inputs=[])
  (/7): BoundParams(name=/7, inputs=[])
  (/8): BoundParams(name=/8, inputs=[])
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2])
  (/input.4): BoundRelu(name=/input.4, inputs=[/input])
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4])
  (/12): BoundRelu(name=/12, inputs=[/input.8])
  (/13): BoundFlatten(name=/13, inputs=[/12])
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6])
  (/15): BoundRelu(name=/15, inputs=[/input.12])
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8])
)
Model prediction is: tensor([-4.09819508, -6.96150303, -3.54694772, -2.57888842,  1.44313431,
        -2.92855549, -6.18935966, -0.67647588, -1.08281994,  3.70497823],
       device='cuda:0')
build_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 14, 14]), torch.Size([1, 1, 32, 7, 7]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-2.50767064]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Split layers:
  BoundConv(name=/input, inputs=[/input.1, /1, /2]): [(BoundRelu(name=/input.4, inputs=[/input]), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6]): [(BoundRelu(name=/15, inputs=[/input.12]), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4]): [(BoundRelu(name=/12, inputs=[/input.8]), 0)]
Keeping slopes for these layers: ['/16']
Keeping slopes for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 14, 14]) unstable 1253
Node /12 input 0: size torch.Size([32, 7, 7]) unstable 191
Node /15 input 0: size torch.Size([100]) unstable 25
-----------------
# of unstable neurons: 1469
-----------------

BaB round 1
batch: 1
Average branched neurons at iteration 1:  1.0000
splitting decisions: 
split level 0: [/input.12, 47] 
split level 1: [/input.12, 83] 
split level 2: [/input.12, 38] 
split level 3: [/input.12, 67] 
split level 4: [/input.12, 22] 
split level 5: [/input.12, 85] 
pruning_in_iteration open status: True
ratio of positive domain = 55 / 64 = 0.859375
pruning-in-iteration extra time: 0.012925148010253906
Time: prepare 0.0034    beta_bound 0.3575    bound 0.3576    transfer 0.0010    finalize 0.0040    func 0.3662    
Accumulated time: func 0.3662    prepare 0.0044    bound 0.3576    beta_bound 0.3575    transfer 0.0010    finalize 0.0040    
batch bounding time:  0.3663499355316162
Current worst splitting domains lb-rhs (depth):
-1.20449 (6), -0.94721 (6), -0.52385 (6), -0.43299 (6), -0.40861 (6), -0.37066 (6), -0.13963 (6), -0.06461 (6), -0.05156 (6), 
length of domains: 9
Time: pickout 0.0007    decision 0.0339    set_bounds 0.0016    solve 0.3664    add 0.0014    
Accumulated time: pickout 0.0007    decision 0.0339    set_bounds 0.0016    solve 0.3664    add 0.0014    
Current (lb-rhs): -1.204491138458252
9 domains visited
Cumulative time: 0.4110720157623291

BaB round 2
batch: 9
Average branched neurons at iteration 2:  1.0000
splitting decisions: 
split level 0: [/input.8, 430] [/input.12, 41] [/input.12, 41] [/input.8, 430] [/input.12, 41] [/input.8, 415] [/input.8, 430] [/input.8, 430] [/input.8, 430] 
split level 1: [/input.12, 41] [/input.8, 430] [/input.8, 430] [/input.12, 41] [/input.8, 430] [/input.8, 414] [/input.12, 41] [/input.12, 41] [/input.8, 415] 
split level 2: [/input.8, 410] [/input.8, 1207] [/input.8, 1207] [/input.8, 414] [/input.8, 414] [/input.8, 905] [/input.8, 1207] [/input.8, 414] [/input.8, 414] 
pruning_in_iteration open status: True
ratio of positive domain = 59 / 72 = 0.8194444444444444
pruning-in-iteration extra time: 0.013715505599975586
Time: prepare 0.0078    beta_bound 0.3315    bound 0.3316    transfer 0.0012    finalize 0.0082    func 0.3488    
Accumulated time: func 0.7151    prepare 0.0127    bound 0.6892    beta_bound 0.6890    transfer 0.0022    finalize 0.0122    
batch bounding time:  0.3491508960723877
Current worst splitting domains lb-rhs (depth):
-0.74548 (9), -0.65040 (9), -0.55668 (9), -0.48398 (9), -0.42494 (9), -0.32983 (9), -0.32130 (9), -0.24901 (9), -0.24301 (9), -0.23261 (9), -0.17682 (9), -0.16312 (9), -0.15162 (9), 
length of domains: 13
Time: pickout 0.0009    decision 0.0229    set_bounds 0.0015    solve 0.3492    add 0.0015    
Accumulated time: pickout 0.0017    decision 0.0569    set_bounds 0.0031    solve 0.7156    add 0.0028    
Current (lb-rhs): -0.7454767227172852
22 domains visited
Cumulative time: 0.7876057624816895

BaB round 3
batch: 13
Average branched neurons at iteration 3:  1.0000
splitting decisions: 
split level 0: [/input.8, 268] [/input.8, 268] [/input.12, 81] [/input.8, 415] [/input.12, 81] [/input.8, 415] [/input.8, 268] [/input.12, 81] [/input.12, 81] [/input.12, 81] 
split level 1: [/input.12, 81] [/input.12, 81] [/input.8, 1207] [/input.12, 81] [/input.8, 1198] [/input.12, 81] [/input.12, 81] [/input.8, 268] [/input.8, 1207] [/input.8, 414] 
pruning_in_iteration open status: True
ratio of positive domain = 32 / 52 = 0.6153846153846154
pruning-in-iteration extra time: 0.016693592071533203
Time: prepare 0.0046    beta_bound 0.3694    bound 0.3695    transfer 0.0010    finalize 0.0046    func 0.3798    
Accumulated time: func 1.0949    prepare 0.0181    bound 1.0587    beta_bound 1.0584    transfer 0.0032    finalize 0.0169    
batch bounding time:  0.3799552917480469
Current worst splitting domains lb-rhs (depth):
-0.51052 (11), -0.41921 (11), -0.38138 (11), -0.33737 (11), -0.32580 (11), -0.29896 (11), -0.23395 (11), -0.19605 (11), -0.19032 (11), -0.18047 (11), -0.17643 (11), -0.14771 (11), -0.14671 (11), -0.09181 (11), -0.09125 (11), -0.08502 (11), -0.06645 (11), -0.05053 (11), -0.03467 (11), -0.01678 (11), 
length of domains: 20
Time: pickout 0.0009    decision 0.0330    set_bounds 0.0025    solve 0.3800    add 0.0025    
Accumulated time: pickout 0.0026    decision 0.0898    set_bounds 0.0056    solve 1.0955    add 0.0053    
Current (lb-rhs): -0.5105199813842773
42 domains visited
Cumulative time: 1.2070462703704834

BaB round 4
batch: 20
Average branched neurons at iteration 4:  1.0000
splitting decisions: 
split level 0: [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 415] [/input.8, 1198] [/input.8, 415] [/input.8, 1198] 
split level 1: [/input.8, 1198] [/input.12, 79] [/input.8, 1198] [/input.8, 1207] [/input.8, 1198] [/input.8, 1198] [/input.8, 1198] [/input.12, 79] [/input.12, 79] [/input.12, 79] 
pruning_in_iteration open status: True
ratio of positive domain = 64 / 80 = 0.8
pruning-in-iteration extra time: 0.01324152946472168
Time: prepare 0.0100    beta_bound 0.3264    bound 0.3265    transfer 0.0009    finalize 0.0054    func 0.3431    
Accumulated time: func 1.4379    prepare 0.0288    bound 1.3851    beta_bound 1.3847    transfer 0.0040    finalize 0.0223    
batch bounding time:  0.34317779541015625
Current worst splitting domains lb-rhs (depth):
-0.36132 (13), -0.30939 (13), -0.20580 (13), -0.18112 (13), -0.16632 (13), -0.12159 (13), -0.08576 (13), -0.06285 (13), -0.05675 (13), -0.05452 (13), -0.05183 (13), -0.04228 (13), -0.02463 (13), -0.01474 (13), -0.01081 (13), -0.00912 (13), 
length of domains: 16
Time: pickout 0.0012    decision 0.0321    set_bounds 0.0019    solve 0.3432    add 0.0015    
Accumulated time: pickout 0.0038    decision 0.1220    set_bounds 0.0075    solve 1.4387    add 0.0068    
Current (lb-rhs): -0.3613150119781494
58 domains visited
Cumulative time: 1.5876009464263916

BaB round 5
batch: 16
Average branched neurons at iteration 5:  1.0000
splitting decisions: 
split level 0: [/input.12, 79] [/input.12, 79] [/input.12, 79] [/input.8, 1059] [/input.8, 415] [/input.8, 415] [/input.12, 79] [/input.12, 79] [/input.12, 79] [/input.8, 1059] 
split level 1: [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 268] [/input.8, 618] [/input.8, 618] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] [/input.8, 1207] 
pruning_in_iteration open status: True
ratio of positive domain = 56 / 64 = 0.875
pruning-in-iteration extra time: 0.014431953430175781
Time: prepare 0.0050    beta_bound 0.3277    bound 0.3278    transfer 0.0009    finalize 0.0049    func 0.3386    
Accumulated time: func 1.7765    prepare 0.0343    bound 1.7129    beta_bound 1.7124    transfer 0.0049    finalize 0.0271    
batch bounding time:  0.338731050491333
Current worst splitting domains lb-rhs (depth):
-0.16304 (15), -0.11195 (15), -0.08843 (15), -0.08571 (15), -0.08567 (15), -0.06860 (15), -0.03394 (15), -0.02560 (15), 
length of domains: 8
Time: pickout 0.0009    decision 0.0211    set_bounds 0.0013    solve 0.3387    add 0.0013    
Accumulated time: pickout 0.0047    decision 0.1431    set_bounds 0.0088    solve 1.7775    add 0.0081    
Current (lb-rhs): -0.16304373741149902
66 domains visited
Cumulative time: 1.9515676498413086

BaB round 6
batch: 8
Average branched neurons at iteration 6:  1.0000
splitting decisions: 
split level 0: [/input.8, 914] [/input.8, 1059] [/input.8, 1059] [/input.8, 1059] [/input.8, 277] [/input.8, 277] [/input.8, 1059] [/input.8, 1059] 
split level 1: [/input.8, 1207] [/input.8, 914] [/input.8, 725] [/input.8, 725] [/input.8, 725] [/input.8, 905] [/input.8, 277] [/input.8, 277] 
split level 2: [/input.8, 277] [/input.8, 1207] [/input.8, 277] [/input.8, 277] [/input.8, 905] [/input.8, 725] [/input.8, 725] [/input.8, 725] 

all verified at 10th iter
pruning_in_iteration open status: True
ratio of positive domain = 64 / 64 = 1.0
pruning-in-iteration extra time: 0.007160663604736328
Time: prepare 0.0071    beta_bound 0.1702    bound 0.1703    transfer 0.0007    finalize 0.0056    func 0.1838    
Accumulated time: func 1.9604    prepare 0.0419    bound 1.8832    beta_bound 1.8827    transfer 0.0056    finalize 0.0328    
batch bounding time:  0.18399477005004883
length of domains: 0
Time: pickout 0.0014    decision 0.0217    set_bounds 0.0012    solve 0.1840    add 0.0002    
Accumulated time: pickout 0.0061    decision 0.1648    set_bounds 0.0100    solve 1.9615    add 0.0083    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
66 domains visited
Cumulative time: 2.1606874465942383

Result: safe in 26.1631 seconds
############# Summary #############
Final verified acc: 100.0% (total 1 examples)
Problem instances count: 1 , total verified (safe/unsat): 1 , total falsified (unsafe/sat): 0 , timeout: 0
mean time for ALL instances (total 1):26.162859118021366, max time: 26.16312074661255
mean time for verified SAFE instances(total 1): 26.16312074661255, max time: 26.16312074661255
safe (total 1), index: [0]
